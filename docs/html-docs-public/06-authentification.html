<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Authentification & Comptes | FitMyCV.io</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="./assets/css/style.css?v=1.0.4">
  <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
  <script>mermaid.initialize({ startOnLoad: false });</script>
</head>
<body>
  <div class="layout">
    <div id="sidebar-container"></div>
    <main class="main">
      <div id="header-container"></div>
      <div class="content">
        <div class="breadcrumb">
          <a href="./index.html">Accueil</a>
          <span>/</span>
          <span>Authentification & Comptes</span>
        </div>

        <h1>Authentification & Comptes</h1>
        <p class="lead">
          FitMyCV.io propose quatre méthodes de connexion pour s'adapter aux préférences de chaque utilisateur. Le système d'authentification couvre l'ensemble du cycle de vie du compte : inscription, vérification, gestion du profil, liaison de comptes et suppression. L'extension navigateur dispose de son propre système d'authentification, indépendant de la session web.
        </p>

        <!-- ============================================================ -->
        <!-- 4 METHODES DE CONNEXION                                      -->
        <!-- ============================================================ -->

        <h2>4 méthodes de connexion</h2>

        <p>
          L'utilisateur peut choisir la méthode qui lui convient le mieux. Les trois méthodes OAuth permettent une inscription en un clic avec un email automatiquement vérifié. La méthode classique par email et mot de passe offre un contrôle total et ne dépend d'aucun service tiers.
        </p>

        <div class="diagram">
          <div class="diagram-title">Quatre voies d'accès au compte FitMyCV</div>
          <div class="mermaid">
flowchart LR
    subgraph Methods["MÉTHODES DE CONNEXION"]
        Email["Email et<br/>mot de passe"]
        Google["Google"]
        GitHub["GitHub"]
        Apple["Apple"]
    end

    Email --> Account["Compte<br/>FitMyCV"]
    Google --> Account
    GitHub --> Account
    Apple --> Account

    Account --> Session["Session sécurisée<br/>(7 jours)"]

    style Email fill:#6366f1,stroke:#4f46e5,color:#fff
    style Google fill:#6366f1,stroke:#4f46e5,color:#fff
    style GitHub fill:#6366f1,stroke:#4f46e5,color:#fff
    style Apple fill:#6366f1,stroke:#4f46e5,color:#fff
    style Account fill:#8b5cf6,stroke:#7c3aed,color:#fff
    style Session fill:#22c55e,stroke:#16a34a,color:#fff
          </div>
        </div>

        <div class="card-grid">
          <div class="card">
            <h4>Email et mot de passe</h4>
            <p>Inscription classique avec vérification d'email obligatoire. Politique de mot de passe stricte et protection anti-bot sur chaque étape.</p>
          </div>
          <div class="card">
            <h4>Google</h4>
            <p>Connexion en un clic via un compte Google. Email automatiquement vérifié, nom et photo de profil récupérés.</p>
          </div>
          <div class="card">
            <h4>GitHub</h4>
            <p>Connexion en un clic via un compte GitHub. Email primaire vérifié automatiquement utilisé.</p>
          </div>
          <div class="card">
            <h4>Apple</h4>
            <p>Connexion via Apple Sign-In, avec la possibilité de masquer son adresse email. Email automatiquement vérifié.</p>
          </div>
        </div>

        <div class="callout callout-info">
          <div class="callout-title">Fournisseurs conditionnels</div>
          <p>Les méthodes de connexion OAuth sont activées dynamiquement selon la configuration du serveur. Si un fournisseur n'est pas configuré, il n'apparaît simplement pas sur la page de connexion. La méthode email et mot de passe est toujours disponible.</p>
        </div>

        <!-- ============================================================ -->
        <!-- PARCOURS INSCRIPTION                                         -->
        <!-- ============================================================ -->

        <h2>Parcours d'inscription</h2>

        <h3>Inscription par email (6 étapes)</h3>

        <p>
          L'inscription par email suit un parcours sécurisé en 6 étapes, de la création du compte jusqu'à la connexion automatique après vérification.
        </p>

        <div class="diagram">
          <div class="diagram-title">Parcours d'inscription par email</div>
          <div class="mermaid">
sequenceDiagram
    participant U as Utilisateur
    participant F as FitMyCV
    participant E as Service d'emails

    U->>F: 1. Remplit le formulaire (nom, email, mot de passe)
    F->>F: 2. Vérification anti-bot + validation du mot de passe
    F->>F: 3. Création du compte (email non vérifié)
    F->>E: 4. Envoi de l'email de vérification (lien valide 24h)
    E->>U: 5. Clic sur le lien de vérification
    U->>F: 6. Email vérifié, connexion automatique sécurisée
    Note over F: Plan gratuit attribué + email de bienvenue
          </div>
        </div>

        <table>
          <thead>
            <tr>
              <th>Étape</th>
              <th>Action</th>
              <th>Sécurité</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><strong>1. Formulaire</strong></td>
              <td>L'utilisateur saisit son prénom, nom, email et mot de passe</td>
              <td>Nettoyage des entrées, vérification de l'unicité de l'email</td>
            </tr>
            <tr>
              <td><strong>2. Validation</strong></td>
              <td>Vérification anti-bot et validation du mot de passe (8 règles)</td>
              <td>reCAPTCHA v3 + politique de mot de passe stricte</td>
            </tr>
            <tr>
              <td><strong>3. Création</strong></td>
              <td>Le compte est créé avec un email non vérifié</td>
              <td>Mot de passe chiffré par hachage cryptographique</td>
            </tr>
            <tr>
              <td><strong>4. Vérification</strong></td>
              <td>Un email contenant un lien de vérification est envoyé</td>
              <td>Jeton cryptographique, valide 24 heures, usage unique</td>
            </tr>
            <tr>
              <td><strong>5. Confirmation</strong></td>
              <td>L'utilisateur clique sur le lien dans l'email</td>
              <td>Le jeton est consommé et supprimé après utilisation</td>
            </tr>
            <tr>
              <td><strong>6. Connexion</strong></td>
              <td>Connexion automatique sécurisée, redirection vers l'accueil</td>
              <td>Jeton de connexion automatique valide 5 minutes, usage unique</td>
            </tr>
          </tbody>
        </table>

        <h3>Inscription via OAuth (3 étapes)</h3>

        <p>
          Les méthodes OAuth (Google, GitHub, Apple) offrent un parcours simplifié en 3 étapes. L'email est automatiquement vérifié et le plan gratuit est attribué immédiatement.
        </p>

        <div class="diagram">
          <div class="diagram-title">Parcours d'inscription OAuth</div>
          <div class="mermaid">
sequenceDiagram
    participant U as Utilisateur
    participant F as FitMyCV
    participant P as Fournisseur (Google, GitHub, Apple)

    U->>F: 1. Clic sur le bouton du fournisseur
    F->>P: Redirection vers la page de consentement
    P->>U: Demande d'autorisation
    U->>P: 2. Autorise l'accès
    P->>F: Profil et email vérifiés
    F->>F: 3. Compte créé, plan gratuit attribué, session active
    Note over F: Email de bienvenue envoyé
    F->>U: Redirection vers l'accueil
          </div>
        </div>

        <div class="callout callout-success">
          <div class="callout-title">Connexion instantanée</div>
          <p>Pour un utilisateur qui possède déjà un compte, la connexion OAuth est encore plus rapide : clic sur le bouton, autorisation, et la session est immédiatement créée. Aucune saisie de mot de passe nécessaire.</p>
        </div>

        <!-- ============================================================ -->
        <!-- GESTION DU COMPTE                                            -->
        <!-- ============================================================ -->

        <h2>Gestion du compte</h2>

        <p>
          Une fois inscrit, l'utilisateur dispose d'un ensemble complet de fonctionnalités pour gérer son compte depuis sa page de profil.
        </p>

        <h3>Liaison et déliaison de comptes OAuth</h3>

        <p>
          Un utilisateur peut <strong>lier</strong> un fournisseur OAuth supplémentaire à son compte existant &mdash; par exemple, ajouter Google à un compte créé par email. Il peut également <strong>délier</strong> un fournisseur, à condition de conserver au moins deux méthodes de connexion actives pour éviter tout verrouillage.
        </p>

        <table>
          <thead>
            <tr>
              <th>Action</th>
              <th>Condition</th>
              <th>Sécurité</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><strong>Lier un fournisseur</strong></td>
              <td>L'email du compte OAuth doit correspondre à l'email FitMyCV</td>
              <td>Protection anti-bot + jeton anti-falsification</td>
            </tr>
            <tr>
              <td><strong>Délier un fournisseur</strong></td>
              <td>L'utilisateur doit conserver au moins 2 méthodes de connexion</td>
              <td>Prévention du verrouillage de compte</td>
            </tr>
          </tbody>
        </table>

        <h3>Réinitialisation du mot de passe</h3>

        <p>
          Le processus de réinitialisation est conçu pour être sécurisé tout en restant simple pour l'utilisateur.
        </p>

        <div class="diagram">
          <div class="diagram-title">Réinitialisation du mot de passe oublié</div>
          <div class="mermaid">
flowchart LR
    A["1. Demande de<br/>réinitialisation<br/>(email + anti-bot)"] --> B["2. Email avec lien<br/>(jeton valide 1h)"]
    B --> C["3. Formulaire de<br/>nouveau mot de passe"]
    C --> D["4. Validation et<br/>mise à jour"]

    style A fill:#0ea5e9,stroke:#0284c7,color:#fff
    style B fill:#8b5cf6,stroke:#7c3aed,color:#fff
    style C fill:#f59e0b,stroke:#d97706,color:#fff
    style D fill:#22c55e,stroke:#16a34a,color:#fff
          </div>
        </div>

        <div class="callout callout-info">
          <div class="callout-title">Protection anti-énumération</div>
          <p>Que l'adresse email existe ou non dans le système, la réponse est toujours identique : &laquo; Si un compte existe avec cette adresse, un email a été envoyé. &raquo; Cette mesure empêche un attaquant de découvrir quels emails sont inscrits sur la plateforme.</p>
        </div>

        <h3>Changement d'email</h3>

        <p>
          Le changement d'adresse email est disponible uniquement pour les comptes avec mot de passe (pas pour les comptes OAuth, dont l'email est géré par le fournisseur). Le processus envoie un email de confirmation à la nouvelle adresse, et la modification n'est effective qu'après validation. Un délai minimum de 60 secondes est imposé entre deux demandes.
        </p>

        <h3>Changement de mot de passe</h3>

        <p>
          L'utilisateur peut modifier son mot de passe depuis sa page de profil. L'ancien mot de passe est vérifié avant d'autoriser le changement, et le nouveau mot de passe doit respecter la même politique stricte que lors de l'inscription.
        </p>

        <h3>Suppression de compte</h3>

        <p>
          La suppression est définitive et entraîne la disparition complète de toutes les données associées. Le processus est conçu pour être sûr et transparent.
        </p>

        <table>
          <thead>
            <tr>
              <th>Étape</th>
              <th>Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><strong>Confirmation</strong></td>
              <td>Mot de passe requis (compte email) ou saisie de l'email (compte OAuth)</td>
            </tr>
            <tr>
              <td><strong>Annulation de l'abonnement</strong></td>
              <td>Si l'utilisateur a un abonnement actif, il est automatiquement annulé auprès du prestataire de paiement</td>
            </tr>
            <tr>
              <td><strong>Suppression en cascade</strong></td>
              <td>Toutes les données sont supprimées : CV, offres, historique, préférences, tâches, transactions</td>
            </tr>
          </tbody>
        </table>

        <!-- ============================================================ -->
        <!-- AUTH EXTENSION                                               -->
        <!-- ============================================================ -->

        <h2>Authentification de l'extension navigateur</h2>

        <p>
          L'extension Chrome et Firefox dispose de son propre système d'authentification, <strong>indépendant de la session web</strong>. Ce choix garantit que l'extension fonctionne même si l'utilisateur n'est pas connecté au site, et inversement.
        </p>

        <div class="diagram">
          <div class="diagram-title">Deux méthodes d'obtention du jeton d'extension</div>
          <div class="mermaid">
flowchart LR
    subgraph Login["OBTENTION DU JETON"]
        A["Email et<br/>mot de passe"] -->|"Connexion directe"| B["Jeton d'accès<br/>(7 jours)"]
        C["Session web<br/>existante"] -->|"Depuis le navigateur"| B
    end

    subgraph Usage["UTILISATION"]
        B -->|"Envoi automatique"| D["Vérification"]
        D --> E["Accès à l'API<br/>de l'extension"]
    end

    subgraph Refresh["RENOUVELLEMENT"]
        B -->|"Avant expiration"| F["Nouveau jeton<br/>(7 jours)"]
    end

    style A fill:#0ea5e9,stroke:#0284c7,color:#fff
    style B fill:#f59e0b,stroke:#d97706,color:#fff
    style C fill:#64748b,stroke:#475569,color:#fff
    style D fill:#8b5cf6,stroke:#7c3aed,color:#fff
    style E fill:#6366f1,stroke:#4f46e5,color:#fff
    style F fill:#22c55e,stroke:#16a34a,color:#fff
          </div>
        </div>

        <table>
          <thead>
            <tr>
              <th>Méthode</th>
              <th>Description</th>
              <th>Cas d'usage</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><strong>Connexion directe</strong></td>
              <td>L'utilisateur saisit son email et mot de passe directement dans l'extension</td>
              <td>Première utilisation de l'extension, ou session web expirée</td>
            </tr>
            <tr>
              <td><strong>Depuis la session web</strong></td>
              <td>Le jeton est généré automatiquement à partir d'une session web active</td>
              <td>L'utilisateur est déjà connecté sur le site</td>
            </tr>
          </tbody>
        </table>

        <div class="callout callout-info">
          <div class="callout-title">Renouvellement automatique</div>
          <p>Le jeton d'extension est valide 7 jours et peut être renouvelé automatiquement tant qu'il n'a pas expiré. L'extension gère un renouvellement proactif (avant expiration) et réactif (en cas de refus d'accès), garantissant une expérience fluide sans déconnexion intempestive.</p>
        </div>

        <!-- ============================================================ -->
        <!-- ROLES                                                        -->
        <!-- ============================================================ -->

        <h2>Rôles utilisateur</h2>

        <p>
          Le système de permissions repose sur deux rôles simples et clairement séparés.
        </p>

        <table>
          <thead>
            <tr>
              <th>Rôle</th>
              <th>Accès</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><span class="badge badge-primary">Utilisateur</span></td>
              <td>Tableau de bord, création et gestion de CV, génération IA, profil, paramètres du compte</td>
            </tr>
            <tr>
              <td><span class="badge badge-warning">Administrateur</span></td>
              <td>Tout l'accès utilisateur + tableau de bord d'administration, configuration système et accès en mode maintenance</td>
            </tr>
          </tbody>
        </table>

        <div class="callout callout-warning">
          <div class="callout-title">Mode maintenance</div>
          <p>Le mode maintenance bloque l'accès à tous les utilisateurs non-administrateurs, tant pour la connexion que pour les sessions existantes. Ce mécanisme permet d'effectuer des interventions sur la plateforme sans risque d'impact utilisateur. De plus, la possibilité de désactiver les inscriptions depuis l'administration offre un contrôle supplémentaire.</p>
        </div>

        <!-- ============================================================ -->
        <!-- SECURITE                                                     -->
        <!-- ============================================================ -->

        <h2>Sécurité de l'authentification</h2>

        <p>
          Chaque étape du processus d'authentification est protégée par des mesures de sécurité complémentaires, de la création du compte jusqu'à la gestion quotidienne de la session.
        </p>

        <div class="card-grid">
          <div class="card">
            <h4>Politique de mot de passe stricte</h4>
            <p>Minimum 8 caractères, majuscule, minuscule, chiffre, caractère spécial, maximum 128 caractères. Les mots de passe courants sont refusés via une liste noire.</p>
          </div>
          <div class="card">
            <h4>Protection anti-bot</h4>
            <p>Vérification reCAPTCHA v3 sur l'inscription, la connexion, la réinitialisation de mot de passe, le renvoi de vérification et la liaison OAuth.</p>
          </div>
          <div class="card">
            <h4>Jetons cryptographiques</h4>
            <p>Tous les jetons (vérification email, réinitialisation, connexion automatique) sont générés avec 32 octets aléatoires, ont une expiration stricte et ne sont utilisables qu'une seule fois.</p>
          </div>
          <div class="card">
            <h4>Protections supplémentaires</h4>
            <p>Chiffrement des mots de passe, protection anti-falsification (CSRF) automatique, nettoyage des entrées contre les injections, et limitation de débit sur les opérations sensibles.</p>
          </div>
        </div>

        <!-- ============================================================ -->
        <!-- POINTS CLES                                                  -->
        <!-- ============================================================ -->

        <h2>Points clés à retenir</h2>

        <div class="callout callout-success">
          <div class="callout-title">Flexibilité maximale</div>
          <p>4 méthodes de connexion, liaison dynamique de comptes OAuth, et un système d'authentification d'extension indépendant. L'utilisateur choisit comment il se connecte, et peut combiner plusieurs méthodes sur un seul compte.</p>
        </div>

        <div class="callout callout-info">
          <div class="callout-title">Cycle de vie complet</div>
          <p>De l'inscription à la suppression, chaque étape est gérée : vérification d'email, changement d'email et de mot de passe, liaison de comptes, réinitialisation et suppression avec annulation automatique de l'abonnement.</p>
        </div>

        <div class="callout callout-warning">
          <div class="callout-title">Sécurité à chaque étape</div>
          <p>Politique de mot de passe stricte, protection anti-bot sur tous les points d'entrée, jetons cryptographiques à usage unique, protection anti-énumération, et limitation de débit. La sécurité n'est pas une couche ajoutée : elle est intégrée dans chaque fonctionnalité.</p>
        </div>

      </div>
    </main>
  </div>

  <script src="./assets/js/layout.js?v=1.0.5"></script>
  <script src="./assets/js/main.js?v=1.0.4"></script>
</body>
</html>
