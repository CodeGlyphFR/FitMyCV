<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Authentification & Comptes | FitMyCV.io</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="./assets/css/style.css?v=1.0.4">
  <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
  <script>mermaid.initialize({ startOnLoad: false });</script>
</head>
<body>
  <div class="layout">
    <div id="sidebar-container"></div>
    <main class="main">
      <div id="header-container"></div>
      <div class="content">
        <div class="breadcrumb">
          <a href="./index.html">Accueil</a>
          <span>/</span>
          <span>Authentification & Comptes</span>
        </div>

        <h1>Authentification & Comptes</h1>
        <p class="lead">
          FitMyCV.io propose quatre methodes de connexion pour s'adapter aux preferences de chaque utilisateur. Le systeme d'authentification couvre l'ensemble du cycle de vie du compte : inscription, verification, gestion du profil, liaison de comptes et suppression. L'extension navigateur dispose de son propre systeme d'authentification, independant de la session web.
        </p>

        <!-- ============================================================ -->
        <!-- 4 METHODES DE CONNEXION                                      -->
        <!-- ============================================================ -->

        <h2>4 methodes de connexion</h2>

        <p>
          L'utilisateur peut choisir la methode qui lui convient le mieux. Les trois methodes OAuth permettent une inscription en un clic avec un email automatiquement verifie. La methode classique par email et mot de passe offre un controle total et ne depend d'aucun service tiers.
        </p>

        <div class="diagram">
          <div class="diagram-title">Quatre voies d'acces au compte FitMyCV</div>
          <div class="mermaid">
flowchart LR
    subgraph Methods["METHODES DE CONNEXION"]
        Email["Email et<br/>mot de passe"]
        Google["Google"]
        GitHub["GitHub"]
        Apple["Apple"]
    end

    Email --> Account["Compte<br/>FitMyCV"]
    Google --> Account
    GitHub --> Account
    Apple --> Account

    Account --> Session["Session securisee<br/>(7 jours)"]

    style Email fill:#6366f1,stroke:#4f46e5,color:#fff
    style Google fill:#6366f1,stroke:#4f46e5,color:#fff
    style GitHub fill:#6366f1,stroke:#4f46e5,color:#fff
    style Apple fill:#6366f1,stroke:#4f46e5,color:#fff
    style Account fill:#8b5cf6,stroke:#7c3aed,color:#fff
    style Session fill:#22c55e,stroke:#16a34a,color:#fff
          </div>
        </div>

        <div class="card-grid">
          <div class="card">
            <h4>Email et mot de passe</h4>
            <p>Inscription classique avec verification d'email obligatoire. Politique de mot de passe stricte et protection anti-bot sur chaque etape.</p>
          </div>
          <div class="card">
            <h4>Google</h4>
            <p>Connexion en un clic via un compte Google. Email automatiquement verifie, nom et photo de profil recuperes.</p>
          </div>
          <div class="card">
            <h4>GitHub</h4>
            <p>Connexion en un clic via un compte GitHub. Email primaire verifie automatiquement utilise.</p>
          </div>
          <div class="card">
            <h4>Apple</h4>
            <p>Connexion via Apple Sign-In, avec la possibilite de masquer son adresse email. Email automatiquement verifie.</p>
          </div>
        </div>

        <div class="callout callout-info">
          <div class="callout-title">Fournisseurs conditionnels</div>
          <p>Les methodes de connexion OAuth sont activees dynamiquement selon la configuration du serveur. Si un fournisseur n'est pas configure, il n'apparait simplement pas sur la page de connexion. La methode email et mot de passe est toujours disponible.</p>
        </div>

        <!-- ============================================================ -->
        <!-- PARCOURS INSCRIPTION                                         -->
        <!-- ============================================================ -->

        <h2>Parcours d'inscription</h2>

        <h3>Inscription par email (6 etapes)</h3>

        <p>
          L'inscription par email suit un parcours securise en 6 etapes, de la creation du compte jusqu'a la connexion automatique apres verification.
        </p>

        <div class="diagram">
          <div class="diagram-title">Parcours d'inscription par email</div>
          <div class="mermaid">
sequenceDiagram
    participant U as Utilisateur
    participant F as FitMyCV
    participant E as Service d'emails

    U->>F: 1. Remplit le formulaire (nom, email, mot de passe)
    F->>F: 2. Verification anti-bot + validation du mot de passe
    F->>F: 3. Creation du compte (email non verifie)
    F->>E: 4. Envoi de l'email de verification (lien valide 24h)
    E->>U: 5. Clic sur le lien de verification
    U->>F: 6. Email verifie, connexion automatique securisee
    Note over F: Plan gratuit attribue + email de bienvenue
          </div>
        </div>

        <table>
          <thead>
            <tr>
              <th>Etape</th>
              <th>Action</th>
              <th>Securite</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><strong>1. Formulaire</strong></td>
              <td>L'utilisateur saisit son prenom, nom, email et mot de passe</td>
              <td>Nettoyage des entrees, verification de l'unicite de l'email</td>
            </tr>
            <tr>
              <td><strong>2. Validation</strong></td>
              <td>Verification anti-bot et validation du mot de passe (8 regles)</td>
              <td>reCAPTCHA v3 + politique de mot de passe stricte</td>
            </tr>
            <tr>
              <td><strong>3. Creation</strong></td>
              <td>Le compte est cree avec un email non verifie</td>
              <td>Mot de passe chiffre par hachage cryptographique</td>
            </tr>
            <tr>
              <td><strong>4. Verification</strong></td>
              <td>Un email contenant un lien de verification est envoye</td>
              <td>Jeton cryptographique, valide 24 heures, usage unique</td>
            </tr>
            <tr>
              <td><strong>5. Confirmation</strong></td>
              <td>L'utilisateur clique sur le lien dans l'email</td>
              <td>Le jeton est consomme et supprime apres utilisation</td>
            </tr>
            <tr>
              <td><strong>6. Connexion</strong></td>
              <td>Connexion automatique securisee, redirection vers l'accueil</td>
              <td>Jeton de connexion automatique valide 5 minutes, usage unique</td>
            </tr>
          </tbody>
        </table>

        <h3>Inscription via OAuth (3 etapes)</h3>

        <p>
          Les methodes OAuth (Google, GitHub, Apple) offrent un parcours simplifie en 3 etapes. L'email est automatiquement verifie et le plan gratuit est attribue immediatement.
        </p>

        <div class="diagram">
          <div class="diagram-title">Parcours d'inscription OAuth</div>
          <div class="mermaid">
sequenceDiagram
    participant U as Utilisateur
    participant F as FitMyCV
    participant P as Fournisseur (Google, GitHub, Apple)

    U->>F: 1. Clic sur le bouton du fournisseur
    F->>P: Redirection vers la page de consentement
    P->>U: Demande d'autorisation
    U->>P: 2. Autorise l'acces
    P->>F: Profil et email verifies
    F->>F: 3. Compte cree, plan gratuit attribue, session active
    Note over F: Email de bienvenue envoye
    F->>U: Redirection vers l'accueil
          </div>
        </div>

        <div class="callout callout-success">
          <div class="callout-title">Connexion instantanee</div>
          <p>Pour un utilisateur qui possede deja un compte, la connexion OAuth est encore plus rapide : clic sur le bouton, autorisation, et la session est immediatement creee. Aucune saisie de mot de passe necessaire.</p>
        </div>

        <!-- ============================================================ -->
        <!-- GESTION DU COMPTE                                            -->
        <!-- ============================================================ -->

        <h2>Gestion du compte</h2>

        <p>
          Une fois inscrit, l'utilisateur dispose d'un ensemble complet de fonctionnalites pour gerer son compte depuis sa page de profil.
        </p>

        <h3>Liaison et deliaison de comptes OAuth</h3>

        <p>
          Un utilisateur peut <strong>lier</strong> un fournisseur OAuth supplementaire a son compte existant &mdash; par exemple, ajouter Google a un compte cree par email. Il peut egalement <strong>delier</strong> un fournisseur, a condition de conserver au moins deux methodes de connexion actives pour eviter tout verrouillage.
        </p>

        <table>
          <thead>
            <tr>
              <th>Action</th>
              <th>Condition</th>
              <th>Securite</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><strong>Lier un fournisseur</strong></td>
              <td>L'email du compte OAuth doit correspondre a l'email FitMyCV</td>
              <td>Protection anti-bot + jeton anti-falsification</td>
            </tr>
            <tr>
              <td><strong>Delier un fournisseur</strong></td>
              <td>L'utilisateur doit conserver au moins 2 methodes de connexion</td>
              <td>Prevention du verrouillage de compte</td>
            </tr>
          </tbody>
        </table>

        <h3>Reinitialisation du mot de passe</h3>

        <p>
          Le processus de reinitialisation est concu pour etre securise tout en restant simple pour l'utilisateur.
        </p>

        <div class="diagram">
          <div class="diagram-title">Reinitialisation du mot de passe oublie</div>
          <div class="mermaid">
flowchart LR
    A["1. Demande de<br/>reinitialisation<br/>(email + anti-bot)"] --> B["2. Email avec lien<br/>(jeton valide 1h)"]
    B --> C["3. Formulaire de<br/>nouveau mot de passe"]
    C --> D["4. Validation et<br/>mise a jour"]

    style A fill:#0ea5e9,stroke:#0284c7,color:#fff
    style B fill:#8b5cf6,stroke:#7c3aed,color:#fff
    style C fill:#f59e0b,stroke:#d97706,color:#fff
    style D fill:#22c55e,stroke:#16a34a,color:#fff
          </div>
        </div>

        <div class="callout callout-info">
          <div class="callout-title">Protection anti-enumeration</div>
          <p>Que l'adresse email existe ou non dans le systeme, la reponse est toujours identique : &laquo; Si un compte existe avec cette adresse, un email a ete envoye. &raquo; Cette mesure empeche un attaquant de decouvrir quels emails sont inscrits sur la plateforme.</p>
        </div>

        <h3>Changement d'email</h3>

        <p>
          Le changement d'adresse email est disponible uniquement pour les comptes avec mot de passe (pas pour les comptes OAuth, dont l'email est gere par le fournisseur). Le processus envoie un email de confirmation a la nouvelle adresse, et la modification n'est effective qu'apres validation. Un delai minimum de 60 secondes est impose entre deux demandes.
        </p>

        <h3>Changement de mot de passe</h3>

        <p>
          L'utilisateur peut modifier son mot de passe depuis sa page de profil. L'ancien mot de passe est verifie avant d'autoriser le changement, et le nouveau mot de passe doit respecter la meme politique stricte que lors de l'inscription.
        </p>

        <h3>Suppression de compte</h3>

        <p>
          La suppression est definitive et entraine la disparition complete de toutes les donnees associees. Le processus est concu pour etre sur et transparent.
        </p>

        <table>
          <thead>
            <tr>
              <th>Etape</th>
              <th>Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><strong>Confirmation</strong></td>
              <td>Mot de passe requis (compte email) ou saisie de l'email (compte OAuth)</td>
            </tr>
            <tr>
              <td><strong>Annulation de l'abonnement</strong></td>
              <td>Si l'utilisateur a un abonnement actif, il est automatiquement annule aupres du prestataire de paiement</td>
            </tr>
            <tr>
              <td><strong>Suppression en cascade</strong></td>
              <td>Toutes les donnees sont supprimees : CV, offres, historique, preferences, taches, transactions</td>
            </tr>
          </tbody>
        </table>

        <!-- ============================================================ -->
        <!-- AUTH EXTENSION                                               -->
        <!-- ============================================================ -->

        <h2>Authentification de l'extension navigateur</h2>

        <p>
          L'extension Chrome et Firefox dispose de son propre systeme d'authentification, <strong>independant de la session web</strong>. Ce choix garantit que l'extension fonctionne meme si l'utilisateur n'est pas connecte au site, et inversement.
        </p>

        <div class="diagram">
          <div class="diagram-title">Deux methodes d'obtention du jeton d'extension</div>
          <div class="mermaid">
flowchart LR
    subgraph Login["OBTENTION DU JETON"]
        A["Email et<br/>mot de passe"] -->|"Connexion directe"| B["Jeton d'acces<br/>(7 jours)"]
        C["Session web<br/>existante"] -->|"Depuis le navigateur"| B
    end

    subgraph Usage["UTILISATION"]
        B -->|"Envoi automatique"| D["Verification"]
        D --> E["Acces a l'API<br/>de l'extension"]
    end

    subgraph Refresh["RENOUVELLEMENT"]
        B -->|"Avant expiration"| F["Nouveau jeton<br/>(7 jours)"]
    end

    style A fill:#0ea5e9,stroke:#0284c7,color:#fff
    style B fill:#f59e0b,stroke:#d97706,color:#fff
    style C fill:#64748b,stroke:#475569,color:#fff
    style D fill:#8b5cf6,stroke:#7c3aed,color:#fff
    style E fill:#6366f1,stroke:#4f46e5,color:#fff
    style F fill:#22c55e,stroke:#16a34a,color:#fff
          </div>
        </div>

        <table>
          <thead>
            <tr>
              <th>Methode</th>
              <th>Description</th>
              <th>Cas d'usage</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><strong>Connexion directe</strong></td>
              <td>L'utilisateur saisit son email et mot de passe directement dans l'extension</td>
              <td>Premiere utilisation de l'extension, ou session web expiree</td>
            </tr>
            <tr>
              <td><strong>Depuis la session web</strong></td>
              <td>Le jeton est genere automatiquement a partir d'une session web active</td>
              <td>L'utilisateur est deja connecte sur le site</td>
            </tr>
          </tbody>
        </table>

        <div class="callout callout-info">
          <div class="callout-title">Renouvellement automatique</div>
          <p>Le jeton d'extension est valide 7 jours et peut etre renouvele automatiquement tant qu'il n'a pas expire. L'extension gere un renouvellement proactif (avant expiration) et reactif (en cas de refus d'acces), garantissant une experience fluide sans deconnexion intempestive.</p>
        </div>

        <!-- ============================================================ -->
        <!-- ROLES                                                        -->
        <!-- ============================================================ -->

        <h2>Roles utilisateur</h2>

        <p>
          Le systeme de permissions repose sur deux roles simples et clairement separes.
        </p>

        <table>
          <thead>
            <tr>
              <th>Role</th>
              <th>Acces</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><span class="badge badge-primary">Utilisateur</span></td>
              <td>Tableau de bord, creation et gestion de CV, generation IA, profil, parametres du compte</td>
            </tr>
            <tr>
              <td><span class="badge badge-warning">Administrateur</span></td>
              <td>Tout l'acces utilisateur + tableau de bord d'administration, configuration systeme et acces en mode maintenance</td>
            </tr>
          </tbody>
        </table>

        <div class="callout callout-warning">
          <div class="callout-title">Mode maintenance</div>
          <p>Le mode maintenance bloque l'acces a tous les utilisateurs non-administrateurs, tant pour la connexion que pour les sessions existantes. Ce mecanisme permet d'effectuer des interventions sur la plateforme sans risque d'impact utilisateur. De plus, la possibilite de desactiver les inscriptions depuis l'administration offre un controle supplementaire.</p>
        </div>

        <!-- ============================================================ -->
        <!-- SECURITE                                                     -->
        <!-- ============================================================ -->

        <h2>Securite de l'authentification</h2>

        <p>
          Chaque etape du processus d'authentification est protegee par des mesures de securite complementaires, de la creation du compte jusqu'a la gestion quotidienne de la session.
        </p>

        <div class="card-grid">
          <div class="card">
            <h4>Politique de mot de passe stricte</h4>
            <p>Minimum 8 caracteres, majuscule, minuscule, chiffre, caractere special, maximum 128 caracteres. Les mots de passe courants sont refuses via une liste noire.</p>
          </div>
          <div class="card">
            <h4>Protection anti-bot</h4>
            <p>Verification reCAPTCHA v3 sur l'inscription, la connexion, la reinitialisation de mot de passe, le renvoi de verification et la liaison OAuth.</p>
          </div>
          <div class="card">
            <h4>Jetons cryptographiques</h4>
            <p>Tous les jetons (verification email, reinitialisation, connexion automatique) sont generes avec 32 octets aleatoires, ont une expiration stricte et ne sont utilisables qu'une seule fois.</p>
          </div>
          <div class="card">
            <h4>Protections supplementaires</h4>
            <p>Chiffrement des mots de passe, protection anti-falsification (CSRF) automatique, nettoyage des entrees contre les injections, et limitation de debit sur les operations sensibles.</p>
          </div>
        </div>

        <!-- ============================================================ -->
        <!-- POINTS CLES                                                  -->
        <!-- ============================================================ -->

        <h2>Points cles a retenir</h2>

        <div class="callout callout-success">
          <div class="callout-title">Flexibilite maximale</div>
          <p>4 methodes de connexion, liaison dynamique de comptes OAuth, et un systeme d'authentification d'extension independant. L'utilisateur choisit comment il se connecte, et peut combiner plusieurs methodes sur un seul compte.</p>
        </div>

        <div class="callout callout-info">
          <div class="callout-title">Cycle de vie complet</div>
          <p>De l'inscription a la suppression, chaque etape est geree : verification d'email, changement d'email et de mot de passe, liaison de comptes, reinitialisation et suppression avec annulation automatique de l'abonnement.</p>
        </div>

        <div class="callout callout-warning">
          <div class="callout-title">Securite a chaque etape</div>
          <p>Politique de mot de passe stricte, protection anti-bot sur tous les points d'entree, jetons cryptographiques a usage unique, protection anti-enumeration, et limitation de debit. La securite n'est pas une couche ajoutee : elle est integree dans chaque fonctionnalite.</p>
        </div>

      </div>
    </main>
  </div>

  <script src="./assets/js/layout.js?v=1.0.4"></script>
  <script src="./assets/js/main.js?v=1.0.4"></script>
</body>
</html>
