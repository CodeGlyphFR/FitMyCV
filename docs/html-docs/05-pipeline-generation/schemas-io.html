<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Schemas I/O - Pipeline G&eacute;n&eacute;ration | FitMyCV.io</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../assets/css/style.css?v=1.0.4">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
  <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
  <script>mermaid.initialize({ startOnLoad: false });</script>
</head>
<body>
  <div class="layout">
    <div id="sidebar-container"></div>
    <main class="main">
      <div id="header-container"></div>
      <div class="content">
        <div class="breadcrumb">
          <a href="../index.html">Docs</a>
          <span>/</span>
          <a href="./overview.html">Pipeline G&eacute;n&eacute;ration</a>
          <span>/</span>
          <span>Schemas I/O</span>
        </div>

        <h1>Schemas I/O</h1>
        <p class="lead">
          Le pipeline utilise <strong>10 JSON Schemas</strong> pour garantir la structure des r&eacute;ponses OpenAI via <strong>Structured Outputs</strong> (<code>strict: true</code>). Chaque phase dispose d'un schema qui d&eacute;finit pr&eacute;cis&eacute;ment le format de sortie attendu, &eacute;liminant toute ambigu&iuml;t&eacute; dans les r&eacute;ponses de l'IA.
        </p>

        <!-- ==================== STRUCTURED OUTPUTS ==================== -->
        <h2>Structured Outputs OpenAI</h2>

        <div class="callout callout-info">
          <div class="callout-title">Mode strict</div>
          <p>Avec <code>strict: true</code>, OpenAI garantit que la r&eacute;ponse respecte exactement le schema. Aucun champ suppl&eacute;mentaire, aucune valeur hors &eacute;num&eacute;ration. Tous les schemas du pipeline utilisent <code>additionalProperties: false</code> pour un contr&ocirc;le total.</p>
        </div>

        <pre><code class="language-javascript">// Utilisation dans chaque phase du pipeline
const response = await openai.chat.completions.create({
  model: modelName,
  messages: [
    { role: 'system', content: systemPrompt },
    { role: 'user', content: userPrompt }
  ],
  response_format: {
    type: 'json_schema',
    json_schema: {
      name: 'batch_experience',    // Nom unique du schema
      schema: schema,              // Contenu du fichier JSON
      strict: true                 // Validation stricte
    }
  }
});</code></pre>

        <!-- ==================== STRUCTURE DES FICHIERS ==================== -->
        <h2>Structure des Fichiers</h2>

        <pre><code class="language-bash">lib/features/cv-adaptation/schemas/
├── classificationSchema.json       # Phase 0.5 : Classification (cv_classification)
├── batchExperienceSchema.json      # Phase 1a : Exp&eacute;riences (adapted_experience)
├── batchProjectSchema.json         # Phase 1b : Projets (adapted_project)
├── batchExtrasSchema.json          # Phase 1c : Extras (adapted_extras)
├── batchEducationSchema.json       # Phase 1d : Education (adapted_education)
├── batchLanguagesSchema.json       # Phase 1e : Langues (adapted_languages)
├── batchSkillsSchema.json          # Phase 1f : Skills (adapted_skills)
├── batchSummarySchema.json         # Phase 1g : Summary (cv_summary)
├── skillsMatchSchema.json          # Sous-phase skills : Correspondance (skills_match_result)
└── recomposeLanguagesSchema.json   # Post-traitement : Langues (adapted_languages)</code></pre>

        <!-- ==================== SCHEMA 1 : CLASSIFICATION ==================== -->
        <h2>1. classificationSchema.json</h2>

        <p><span class="badge badge-primary">Phase 0.5</span> <strong>Nom :</strong> <code>cv_classification</code></p>

        <div class="data-flow">
          <div class="data-flow-header">CLASSIFICATION &mdash; Tri des exp&eacute;riences et projets</div>

          <div class="data-flow-section data-flow-output">
            <div class="data-flow-label">Structure de sortie</div>
            <pre><code class="language-json">{
  "experiences": [
    {
      "index": 0,
      "action": "KEEP",
      "reason": "Exp&eacute;rience en cours, emploi principal du candidat"
    },
    {
      "index": 1,
      "action": "MOVE_TO_PROJECTS",
      "reason": "Projet personnel termin&eacute;, pertinent pour le poste"
    },
    {
      "index": 2,
      "action": "REMOVE",
      "reason": "Hors fen&ecirc;tre temporelle et non pertinent pour le poste"
    }
  ],
  "projects": [
    {
      "index": 0,
      "action": "KEEP",
      "reason": "Technologies align&eacute;es avec l'offre"
    }
  ]
}</code></pre>
          </div>
        </div>

        <table>
          <thead>
            <tr><th>Champ</th><th>Type</th><th>Description</th></tr>
          </thead>
          <tbody>
            <tr><td><code>experiences[].index</code></td><td><code>integer</code></td><td>Index 0-based de l'exp&eacute;rience dans le tableau source</td></tr>
            <tr><td><code>experiences[].action</code></td><td><code>enum</code></td><td><code>KEEP</code>, <code>REMOVE</code>, <code>MOVE_TO_PROJECTS</code></td></tr>
            <tr><td><code>experiences[].reason</code></td><td><code>string</code></td><td>Explication concise de la d&eacute;cision</td></tr>
            <tr><td><code>projects[].index</code></td><td><code>integer</code></td><td>Index 0-based du projet dans le tableau source</td></tr>
            <tr><td><code>projects[].action</code></td><td><code>enum</code></td><td><code>KEEP</code>, <code>REMOVE</code> (pas de MOVE_TO_PROJECTS)</td></tr>
            <tr><td><code>projects[].reason</code></td><td><code>string</code></td><td>Explication concise de la d&eacute;cision</td></tr>
          </tbody>
        </table>

        <!-- ==================== SCHEMA 2 : EXPERIENCE ==================== -->
        <h2>2. batchExperienceSchema.json</h2>

        <p><span class="badge badge-warning">Phase 1a</span> <strong>Nom :</strong> <code>adapted_experience</code></p>

        <div class="callout callout-warning">
          <div class="callout-title">Pattern {value, reason} | null</div>
          <p>Les champs modifiables (<code>description</code>, <code>responsibilities</code>, <code>deliverables</code>) utilisent un pattern sp&eacute;cifique : <code>{"value": ..., "reason": "..."}</code> si modifi&eacute;, <code>null</code> si identique &agrave; la source. Le champ <code>title</code> retourne toujours un objet <code>{value, reason}</code> (jamais null).</p>
        </div>

        <div class="data-flow">
          <div class="data-flow-header">EXPERIENCE &mdash; Adaptation avec tra&ccedil;abilit&eacute;</div>

          <div class="data-flow-section data-flow-output">
            <div class="data-flow-label">Exemple de sortie</div>
            <pre><code class="language-json">{
  "title": {
    "value": "Responsable Grands Comptes",
    "reason": "Titre ATS standard pour ce r&ocirc;le commercial"
  },
  "description": null,
  "responsibilities": {
    "value": ["G&eacute;rer le portefeuille clients", "N&eacute;gocier les contrats"],
    "reason": "Simplification et alignement avec l'offre"
  },
  "deliverables": null,
  "skill_changes": [
    {
      "before": "Photoshop",
      "after": null,
      "reason": "Non pertinent pour le poste"
    },
    {
      "before": "Sheets",
      "after": "Excel",
      "reason": "&Eacute;quivalence directe"
    }
  ],
  "domain": "Commercial",
  "years_in_domain": 2.5
}</code></pre>
          </div>
        </div>

        <table>
          <thead>
            <tr><th>Champ</th><th>Type</th><th>Description</th></tr>
          </thead>
          <tbody>
            <tr><td><code>title</code></td><td><code>{value, reason}</code></td><td>Titre de poste ATS-friendly (toujours retourn&eacute;)</td></tr>
            <tr><td><code>description</code></td><td><code>{value, reason} | null</code></td><td>Description modifi&eacute;e ou null si inchang&eacute;e</td></tr>
            <tr><td><code>responsibilities</code></td><td><code>{value: string[], reason} | null</code></td><td>Responsabilit&eacute;s modifi&eacute;es ou null</td></tr>
            <tr><td><code>deliverables</code></td><td><code>{value: string[], reason} | null</code></td><td>R&eacute;sultats chiffr&eacute;s modifi&eacute;s ou null</td></tr>
            <tr><td><code>skill_changes</code></td><td><code>array</code></td><td>UNIQUEMENT les skills modifi&eacute;s/supprim&eacute;s (pas les conserv&eacute;s)</td></tr>
            <tr><td><code>skill_changes[].before</code></td><td><code>string</code></td><td>Nom du skill original</td></tr>
            <tr><td><code>skill_changes[].after</code></td><td><code>string | null</code></td><td>Nouveau nom (null si supprim&eacute;)</td></tr>
            <tr><td><code>domain</code></td><td><code>string</code></td><td>Domaine m&eacute;tier (ex: &laquo; D&eacute;veloppement logiciel &raquo;)</td></tr>
            <tr><td><code>years_in_domain</code></td><td><code>number</code></td><td>Dur&eacute;e en ann&eacute;es (copie de <code>_calculated_years</code>)</td></tr>
          </tbody>
        </table>

        <!-- ==================== SCHEMA 3 : PROJECT ==================== -->
        <h2>3. batchProjectSchema.json</h2>

        <p><span class="badge badge-warning">Phase 1b</span> <strong>Nom :</strong> <code>adapted_project</code></p>

        <div class="data-flow">
          <div class="data-flow-header">PROJECT &mdash; Projet adapt&eacute; avec tra&ccedil;abilit&eacute;</div>

          <div class="data-flow-section data-flow-output">
            <div class="data-flow-label">Exemple de sortie</div>
            <pre><code class="language-json">{
  "name": "E-commerce Platform",
  "role": "D&eacute;veloppeur Full Stack",
  "start_date": "2022-01",
  "end_date": "2023-06",
  "summary": "Plateforme e-commerce B2C d&eacute;velopp&eacute;e avec React et Node.js...",
  "tech_stack": ["React", "Node.js", "PostgreSQL", "Docker"],
  "url": "https://github.com/user/ecommerce",
  "modifications": [
    {
      "field": "summary",
      "action": "modified",
      "before": "Site de vente en ligne cr&eacute;&eacute; avec React.",
      "after": "Plateforme e-commerce B2C d&eacute;velopp&eacute;e avec React et Node.js...",
      "reason": "Mise en avant des technologies demand&eacute;es dans l'offre"
    },
    {
      "field": "tech_stack",
      "action": "reordered",
      "before": "PostgreSQL, Docker, React, Node.js",
      "after": "React, Node.js, PostgreSQL, Docker",
      "reason": "React et Node.js en priorit&eacute; (demand&eacute;s dans l'offre)"
    }
  ]
}</code></pre>
          </div>
        </div>

        <table>
          <thead>
            <tr><th>Champ</th><th>Type</th><th>Description</th></tr>
          </thead>
          <tbody>
            <tr><td><code>name</code></td><td><code>string</code></td><td>Nom du projet</td></tr>
            <tr><td><code>role</code></td><td><code>string</code></td><td>R&ocirc;le sur le projet</td></tr>
            <tr><td><code>start_date</code></td><td><code>string</code></td><td>Format YYYY-MM ou YYYY</td></tr>
            <tr><td><code>end_date</code></td><td><code>string</code></td><td>Format YYYY-MM, YYYY, ou &laquo; present &raquo;</td></tr>
            <tr><td><code>summary</code></td><td><code>string</code></td><td>Description adapt&eacute;e avec mots-cl&eacute;s</td></tr>
            <tr><td><code>tech_stack</code></td><td><code>string[]</code></td><td>Technologies r&eacute;ordonn&eacute;es par pertinence</td></tr>
            <tr><td><code>url</code></td><td><code>string | null</code></td><td>URL du projet (inchang&eacute;e)</td></tr>
            <tr><td><code>modifications[]</code></td><td><code>array</code></td><td>Tra&ccedil;abilit&eacute; des modifications</td></tr>
            <tr><td><code>modifications[].action</code></td><td><code>enum</code></td><td><code>modified</code>, <code>removed</code>, <code>reordered</code>, <code>converted</code></td></tr>
          </tbody>
        </table>

        <!-- ==================== SCHEMA 4 : EXTRAS ==================== -->
        <h2>4. batchExtrasSchema.json</h2>

        <p><span class="badge badge-warning">Phase 1c</span> <strong>Nom :</strong> <code>adapted_extras</code></p>

        <div class="data-flow">
          <div class="data-flow-header">EXTRAS &mdash; Informations compl&eacute;mentaires adapt&eacute;es</div>

          <div class="data-flow-section data-flow-output">
            <div class="data-flow-label">Structure de sortie (3 sections)</div>
            <pre><code class="language-json">{
  "extras": [
    { "name": "Permis", "summary": "Permis B" },
    { "name": "Loisirs", "summary": "Randonn&eacute;e, photographie, &eacute;checs" },
    { "name": "T&eacute;l&eacute;travail", "summary": "Disponible en remote" }
  ],
  "modifications": [
    {
      "field": "V&eacute;hicule",
      "action": "removed",
      "before": "V&eacute;hicule personnel",
      "after": "",
      "reason": "Offre sans d&eacute;placement"
    },
    {
      "field": "T&eacute;l&eacute;travail",
      "action": "added",
      "before": "",
      "after": "Disponible en remote",
      "reason": "Offre mentionne t&eacute;l&eacute;travail hybride"
    }
  ],
  "extras_modifications": [
    {
      "before_name": "Permis",
      "after_name": "Permis",
      "action": "kept",
      "reason": "Offre mentionne d&eacute;placements"
    },
    {
      "before_name": "V&eacute;hicule",
      "after_name": null,
      "action": "removed",
      "reason": "Non pertinent pour le poste"
    },
    {
      "before_name": null,
      "after_name": "T&eacute;l&eacute;travail",
      "action": "added",
      "reason": "Offre mentionne t&eacute;l&eacute;travail"
    }
  ]
}</code></pre>
          </div>
        </div>

        <div class="callout callout-info">
          <div class="callout-title">Double tra&ccedil;abilit&eacute;</div>
          <p>Le schema exige deux niveaux de tra&ccedil;abilit&eacute; : <code>modifications[]</code> pour les changements d&eacute;taill&eacute;s (before/after/reason) et <code>extras_modifications[]</code> pour le mapping explicite entre extras source et extras adapt&eacute;s. Les actions possibles dans <code>extras_modifications</code> sont : <code>kept</code>, <code>modified</code>, <code>removed</code>, <code>added</code>.</p>
        </div>

        <!-- ==================== SCHEMA 5 : EDUCATION ==================== -->
        <h2>5. batchEducationSchema.json</h2>

        <p><span class="badge badge-warning">Phase 1d</span> <strong>Nom :</strong> <code>adapted_education</code></p>

        <div class="data-flow">
          <div class="data-flow-header">EDUCATION &mdash; Formations traduites</div>

          <div class="data-flow-section data-flow-output">
            <div class="data-flow-label">Exemple de sortie</div>
            <pre><code class="language-json">{
  "education": [
    {
      "institution": "&Eacute;cole Polytechnique",
      "degree": "Engineering Degree",
      "field_of_study": "Computer Science",
      "start_date": "2015-09",
      "end_date": "2018-06",
      "location": {
        "city": "Palaiseau",
        "region": "&Icirc;le-de-France",
        "country_code": "FR"
      }
    }
  ],
  "education_modifications": [
    {
      "education_index": 0,
      "degree_before": "Dipl&ocirc;me d'Ing&eacute;nieur",
      "degree_after": "Engineering Degree",
      "field_before": "Informatique",
      "field_after": "Computer Science",
      "action": "modified",
      "reason": "Traduction vers anglais"
    }
  ]
}</code></pre>
          </div>
        </div>

        <table>
          <thead>
            <tr><th>Champ</th><th>Type</th><th>Description</th></tr>
          </thead>
          <tbody>
            <tr><td><code>education[].institution</code></td><td><code>string</code></td><td>Nom propre, conserv&eacute; tel quel</td></tr>
            <tr><td><code>education[].degree</code></td><td><code>string</code></td><td>Dipl&ocirc;me traduit dans la langue cible</td></tr>
            <tr><td><code>education[].field_of_study</code></td><td><code>string</code></td><td>Domaine d'&eacute;tudes traduit</td></tr>
            <tr><td><code>education[].location</code></td><td><code>object | null</code></td><td>Objet avec <code>city</code>, <code>region</code>, <code>country_code</code></td></tr>
            <tr><td><code>education_modifications[].action</code></td><td><code>enum</code></td><td><code>kept</code> ou <code>modified</code></td></tr>
          </tbody>
        </table>

        <!-- ==================== SCHEMA 6 : LANGUAGES ==================== -->
        <h2>6. batchLanguagesSchema.json</h2>

        <p><span class="badge badge-warning">Phase 1e</span> <strong>Nom :</strong> <code>adapted_languages</code></p>

        <div class="data-flow">
          <div class="data-flow-header">LANGUAGES &mdash; Langues traduites et align&eacute;es</div>

          <div class="data-flow-section data-flow-output">
            <div class="data-flow-label">Exemple de sortie</div>
            <pre><code class="language-json">{
  "languages": [
    { "name": "English", "level": "Fluent" },
    { "name": "French", "level": "Native" },
    { "name": "German", "level": "B1" }
  ],
  "language_modifications": [
    {
      "language_index": 0,
      "language_name": "English",
      "name_before": "Anglais",
      "name_after": "English",
      "level_before": "C1",
      "level_after": "Fluent",
      "action": "modified",
      "reason": "Traduction vers anglais et alignement avec exigence 'Fluent English'"
    },
    {
      "language_index": 2,
      "language_name": "German",
      "name_before": "Allemand",
      "name_after": "German",
      "level_before": "B1",
      "level_after": "B1",
      "action": "modified",
      "reason": "Traduction du nom vers anglais, niveau conserv&eacute;"
    }
  ]
}</code></pre>
          </div>
        </div>

        <table>
          <thead>
            <tr><th>Champ</th><th>Type</th><th>Description</th></tr>
          </thead>
          <tbody>
            <tr><td><code>languages[].name</code></td><td><code>string</code></td><td>Nom de la langue dans la langue cible</td></tr>
            <tr><td><code>languages[].level</code></td><td><code>string</code></td><td>Niveau traduit/align&eacute;</td></tr>
            <tr><td><code>language_modifications[].action</code></td><td><code>enum</code></td><td><code>kept</code> (aucun changement de texte) ou <code>modified</code> (toute modification)</td></tr>
            <tr><td><code>language_modifications[].name_before</code></td><td><code>string</code></td><td>Nom avant modification</td></tr>
            <tr><td><code>language_modifications[].level_before</code></td><td><code>string</code></td><td>Niveau avant modification</td></tr>
          </tbody>
        </table>

        <!-- ==================== SCHEMA 7 : SKILLS ==================== -->
        <h2>7. batchSkillsSchema.json</h2>

        <p><span class="badge badge-warning">Phase 1f</span> <strong>Nom :</strong> <code>adapted_skills</code></p>

        <div class="callout callout-error">
          <div class="callout-title">Schema le plus complexe du pipeline</div>
          <p>Ce schema utilise des d&eacute;finitions r&eacute;f&eacute;renc&eacute;es (<code>$defs</code>) pour deux types de skills : <code>skill_with_proficiency</code> (hard_skills, tools) et <code>skill_simple</code> (soft_skills, methodologies). Chaque skill retourn&eacute; inclut un score de probabilit&eacute; de correspondance avec l'offre.</p>
        </div>

        <div class="data-flow">
          <div class="data-flow-header">SKILLS &mdash; 4 cat&eacute;gories avec actions et probabilit&eacute;s</div>

          <div class="data-flow-section data-flow-output">
            <div class="data-flow-label">Exemple de sortie</div>
            <pre><code class="language-json">{
  "hard_skills": [
    {
      "action": "renamed",
      "skill_final": "React",
      "proficiency": 4,
      "probability": 100,
      "reason": "Correspondance exacte avec l'offre",
      "original_value": "React.js",
      "original_position": 0
    },
    {
      "action": "deleted",
      "skill_final": "Photoshop",
      "proficiency": 2,
      "probability": 0,
      "reason": "Aucune correspondance avec les comp&eacute;tences demand&eacute;es",
      "original_value": "Photoshop",
      "original_position": 3
    }
  ],
  "soft_skills": [
    {
      "action": "kept",
      "skill_final": "Leadership",
      "probability": 75,
      "reason": null,
      "original_value": "Leadership",
      "original_position": 0
    }
  ],
  "tools": [],
  "methodologies": []
}</code></pre>
          </div>
        </div>

        <h3>Type skill_with_proficiency (hard_skills, tools)</h3>

        <table>
          <thead>
            <tr><th>Champ</th><th>Type</th><th>Description</th></tr>
          </thead>
          <tbody>
            <tr><td><code>action</code></td><td><code>enum</code></td><td><code>renamed</code>, <code>kept</code>, <code>deleted</code></td></tr>
            <tr><td><code>skill_final</code></td><td><code>string</code></td><td>Nom final dans la langue de l'offre</td></tr>
            <tr><td><code>proficiency</code></td><td><code>integer (0-5)</code></td><td>0=Awareness, 1=Beginner, 2=Intermediate, 3=Proficient, 4=Advanced, 5=Expert</td></tr>
            <tr><td><code>probability</code></td><td><code>integer (0-100)</code></td><td>Score de correspondance avec l'offre</td></tr>
            <tr><td><code>reason</code></td><td><code>string | null</code></td><td>Explication (null si action=kept et m&ecirc;me langue)</td></tr>
            <tr><td><code>original_value</code></td><td><code>string</code></td><td>Nom original dans le CV source</td></tr>
            <tr><td><code>original_position</code></td><td><code>integer</code></td><td>Index de position dans la cat&eacute;gorie source (0-indexed)</td></tr>
          </tbody>
        </table>

        <h3>Type skill_simple (soft_skills, methodologies)</h3>

        <table>
          <thead>
            <tr><th>Champ</th><th>Type</th><th>Description</th></tr>
          </thead>
          <tbody>
            <tr><td><code>action</code></td><td><code>enum</code></td><td><code>renamed</code>, <code>kept</code>, <code>deleted</code></td></tr>
            <tr><td><code>skill_final</code></td><td><code>string</code></td><td>Nom final dans la langue de l'offre</td></tr>
            <tr><td><code>probability</code></td><td><code>integer (0-100)</code></td><td>Score de correspondance</td></tr>
            <tr><td><code>reason</code></td><td><code>string | null</code></td><td>Explication</td></tr>
            <tr><td><code>original_value</code></td><td><code>string</code></td><td>Nom original dans le CV source</td></tr>
            <tr><td><code>original_position</code></td><td><code>integer</code></td><td>Index de position source</td></tr>
          </tbody>
        </table>

        <h3>Actions et leurs r&egrave;gles</h3>

        <table>
          <thead>
            <tr>
              <th>Action</th>
              <th>Probabilit&eacute;</th>
              <th><code>skill_final</code> =</th>
              <th>Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><span class="badge badge-success">renamed</span></td>
              <td>&ge; 80%</td>
              <td>Nom EXACT de l'offre</td>
              <td>Match fort : le skill est renomm&eacute; pour utiliser la terminologie de l'offre</td>
            </tr>
            <tr>
              <td><span class="badge badge-primary">kept</span></td>
              <td>60-79%</td>
              <td>Nom du CV (traduit si langues &ne;)</td>
              <td>Match partiel : le skill est conserv&eacute; avec son nom original</td>
            </tr>
            <tr>
              <td><span class="badge badge-error">deleted</span></td>
              <td>&lt; 60%</td>
              <td>Nom du CV (traduit si langues &ne;)</td>
              <td>Pas de match : le skill est marqu&eacute; pour suppression</td>
            </tr>
          </tbody>
        </table>

        <div class="callout callout-warning">
          <div class="callout-title">Compl&eacute;tude obligatoire</div>
          <p>Chaque skill du CV source DOIT appara&icirc;tre dans la sortie, m&ecirc;me s'il est <code>deleted</code> avec <code>probability: 0</code>. Le nombre total de skills retourn&eacute;s par cat&eacute;gorie DOIT &ecirc;tre &ge; au nombre de skills source. Maximum 6 <code>soft_skills</code> dans le r&eacute;sultat final.</p>
        </div>

        <!-- ==================== SCHEMA 8 : SUMMARY ==================== -->
        <h2>8. batchSummarySchema.json</h2>

        <p><span class="badge badge-warning">Phase 1g</span> <strong>Nom :</strong> <code>cv_summary</code></p>

        <div class="data-flow">
          <div class="data-flow-header">SUMMARY &mdash; R&eacute;sum&eacute; professionnel</div>

          <div class="data-flow-section data-flow-output">
            <div class="data-flow-label">Exemple de sortie</div>
            <pre><code class="language-json">{
  "description": "8 ans d'exp&eacute;rience en d&eacute;veloppement logiciel avec expertise full-stack. Am&eacute;lioration de 40% des performances API gr&acirc;ce &agrave; l'optimisation des requ&ecirc;tes et la mise en cache. Ma&icirc;trise de React, Node.js et AWS pour des applications scalables et performantes.",
  "reason": "R&eacute;sum&eacute; adapt&eacute; pour poste Senior Full-Stack Developer : mise en avant des comp&eacute;tences React, Node.js, AWS demand&eacute;es."
}</code></pre>
          </div>
        </div>

        <table>
          <thead>
            <tr><th>Champ</th><th>Type</th><th>Description</th></tr>
          </thead>
          <tbody>
            <tr><td><code>description</code></td><td><code>string</code></td><td>R&eacute;sum&eacute; professionnel (2-4 phrases, 50-75 mots, langue cible)</td></tr>
            <tr><td><code>reason</code></td><td><code>string</code></td><td>Raison de la g&eacute;n&eacute;ration (langue interface)</td></tr>
          </tbody>
        </table>

        <div class="callout callout-info">
          <div class="callout-title">Schema le plus simple</div>
          <p>Seulement 2 champs obligatoires. La complexit&eacute; est enti&egrave;rement dans le prompt system qui d&eacute;finit la structure DOMAINE + ACCOMPLISSEMENT + VALEUR, les interdictions (pas de titre en d&eacute;but, pas de pronoms personnels, pas de buzzwords) et la validation anti-hallucination.</p>
        </div>

        <!-- ==================== SCHEMA 9 : SKILLS MATCH ==================== -->
        <h2>9. skillsMatchSchema.json</h2>

        <p><span class="badge badge-primary">Sous-phase skills</span> <strong>Nom :</strong> <code>skills_match_result</code></p>

        <div class="data-flow">
          <div class="data-flow-header">SKILLS MATCH &mdash; Correspondance par cat&eacute;gorie (matrice de scores)</div>

          <div class="data-flow-section data-flow-output">
            <div class="data-flow-label">Exemple de sortie</div>
            <pre><code class="language-json">{
  "matches": [
    {
      "cv_skill": "React.js",
      "offer_skill": "React",
      "score": 100,
      "reason": "Variante technique identique",
      "adapted_name": "React"
    },
    {
      "cv_skill": "Comptabilit&eacute; fournisseurs",
      "offer_skill": "Accounts Payable",
      "score": 90,
      "reason": "Traduction directe du terme comptable",
      "adapted_name": "Accounts Payable"
    },
    {
      "cv_skill": "Sage",
      "offer_skill": "SAP",
      "score": 70,
      "reason": "Logiciels ERP de m&ecirc;me cat&eacute;gorie",
      "adapted_name": "SAP"
    }
  ]
}</code></pre>
          </div>
        </div>

        <table>
          <thead>
            <tr><th>Champ</th><th>Type</th><th>Description</th></tr>
          </thead>
          <tbody>
            <tr><td><code>matches[].cv_skill</code></td><td><code>string</code></td><td>Recopie EXACTE du nom dans le CV (jamais modifi&eacute;)</td></tr>
            <tr><td><code>matches[].offer_skill</code></td><td><code>string | null</code></td><td>Skill de l'offre qui matche (null seulement si l'offre est vide)</td></tr>
            <tr><td><code>matches[].score</code></td><td><code>integer (0-100)</code></td><td>Score de correspondance</td></tr>
            <tr><td><code>matches[].reason</code></td><td><code>string | null</code></td><td>Explication (langue interface)</td></tr>
            <tr><td><code>matches[].adapted_name</code></td><td><code>string</code></td><td>Nom adapt&eacute;/traduit dans la langue de l'offre</td></tr>
          </tbody>
        </table>

        <div class="callout callout-warning">
          <div class="callout-title">Filtrage par score</div>
          <p>Seuls les skills avec un score &ge; 60 sont retourn&eacute;s dans <code>matches[]</code>. Les skills en dessous de 60 sont filtr&eacute;s par le prompt (pas par le schema). Le champ <code>offer_skill</code> ne peut &ecirc;tre <code>null</code> que si l'offre n'a AUCUN &eacute;l&eacute;ment pour cette cat&eacute;gorie.</p>
        </div>

        <!-- ==================== SCHEMA 10 : RECOMPOSE LANGUAGES ==================== -->
        <h2>10. recomposeLanguagesSchema.json</h2>

        <p><span class="badge badge-success">Post-traitement</span> <strong>Nom :</strong> <code>adapted_languages</code></p>

        <div class="data-flow">
          <div class="data-flow-header">RECOMPOSE LANGUAGES &mdash; Alignement format niveaux</div>

          <div class="data-flow-section data-flow-output">
            <div class="data-flow-label">Exemple de sortie</div>
            <pre><code class="language-json">{
  "languages": [
    { "name": "Anglais", "level": "Courant" },
    { "name": "Allemand", "level": "B1" }
  ],
  "modifications": {
    "adapted": [
      {
        "name": "Anglais",
        "from": "C1",
        "to": "Courant",
        "reason": "Alignement avec l'exigence 'Anglais courant' de l'offre"
      }
    ],
    "unchanged": ["Allemand"]
  }
}</code></pre>
          </div>
        </div>

        <table>
          <thead>
            <tr><th>Champ</th><th>Type</th><th>Description</th></tr>
          </thead>
          <tbody>
            <tr><td><code>languages[]</code></td><td><code>array</code></td><td>Langues avec niveaux adapt&eacute;s</td></tr>
            <tr><td><code>modifications.adapted[]</code></td><td><code>array</code></td><td>Langues dont le format a &eacute;t&eacute; adapt&eacute; (<code>name</code>, <code>from</code>, <code>to</code>, <code>reason</code>)</td></tr>
            <tr><td><code>modifications.unchanged[]</code></td><td><code>string[]</code></td><td>Noms des langues conserv&eacute;es sans modification</td></tr>
          </tbody>
        </table>

        <!-- ==================== RECAPITULATIF ==================== -->
        <h2>R&eacute;capitulatif des 10 Schemas</h2>

        <table>
          <thead>
            <tr>
              <th>Phase</th>
              <th>Fichier</th>
              <th>Nom schema</th>
              <th>Champs principaux</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><span class="badge badge-primary">0.5</span></td>
              <td><code>classificationSchema.json</code></td>
              <td><code>cv_classification</code></td>
              <td>index, action (KEEP/REMOVE/MOVE_TO_PROJECTS), reason</td>
            </tr>
            <tr>
              <td><span class="badge badge-warning">1a</span></td>
              <td><code>batchExperienceSchema.json</code></td>
              <td><code>adapted_experience</code></td>
              <td>title, description, responsibilities, deliverables ({value,reason}|null), skill_changes, domain</td>
            </tr>
            <tr>
              <td><span class="badge badge-warning">1b</span></td>
              <td><code>batchProjectSchema.json</code></td>
              <td><code>adapted_project</code></td>
              <td>name, role, summary, tech_stack, url, modifications[]</td>
            </tr>
            <tr>
              <td><span class="badge badge-warning">1c</span></td>
              <td><code>batchExtrasSchema.json</code></td>
              <td><code>adapted_extras</code></td>
              <td>extras[], modifications[], extras_modifications[]</td>
            </tr>
            <tr>
              <td><span class="badge badge-warning">1d</span></td>
              <td><code>batchEducationSchema.json</code></td>
              <td><code>adapted_education</code></td>
              <td>education[], education_modifications[] (degree/field before/after)</td>
            </tr>
            <tr>
              <td><span class="badge badge-warning">1e</span></td>
              <td><code>batchLanguagesSchema.json</code></td>
              <td><code>adapted_languages</code></td>
              <td>languages[], language_modifications[] (name/level before/after)</td>
            </tr>
            <tr>
              <td><span class="badge badge-warning">1f</span></td>
              <td><code>batchSkillsSchema.json</code></td>
              <td><code>adapted_skills</code></td>
              <td>hard_skills[], soft_skills[], tools[], methodologies[] (action, skill_final, probability)</td>
            </tr>
            <tr>
              <td><span class="badge badge-warning">1g</span></td>
              <td><code>batchSummarySchema.json</code></td>
              <td><code>cv_summary</code></td>
              <td>description, reason</td>
            </tr>
            <tr>
              <td><span class="badge badge-primary">sub</span></td>
              <td><code>skillsMatchSchema.json</code></td>
              <td><code>skills_match_result</code></td>
              <td>matches[] (cv_skill, offer_skill, score, adapted_name)</td>
            </tr>
            <tr>
              <td><span class="badge badge-success">post</span></td>
              <td><code>recomposeLanguagesSchema.json</code></td>
              <td><code>adapted_languages</code></td>
              <td>languages[], modifications (adapted[], unchanged[])</td>
            </tr>
          </tbody>
        </table>

        <!-- ==================== CONVENTIONS ==================== -->
        <h2>Conventions Transversales</h2>

        <div class="card-grid">
          <div class="card">
            <h4>strict: true</h4>
            <p>Tous les schemas utilisent <code>strict: true</code> et <code>additionalProperties: false</code>. OpenAI garantit que la r&eacute;ponse ne contient aucun champ suppl&eacute;mentaire.</p>
          </div>
          <div class="card">
            <h4>Tra&ccedil;abilit&eacute;</h4>
            <p>Chaque schema inclut un m&eacute;canisme de tra&ccedil;abilit&eacute; : <code>modifications[]</code>, <code>reason</code>, ou <code>before/after</code> pour documenter chaque changement effectu&eacute; par l'IA.</p>
          </div>
          <div class="card">
            <h4>Types nullables</h4>
            <p>Les champs optionnels utilisent <code>type: ["string", "null"]</code> ou <code>type: ["object", "null"]</code> plut&ocirc;t que <code>required: false</code>, conform&eacute;ment aux exigences de Structured Outputs.</p>
          </div>
          <div class="card">
            <h4>Enums strictes</h4>
            <p>Les actions sont toujours d&eacute;finies par des <code>enum</code> (ex: <code>["KEEP", "REMOVE", "MOVE_TO_PROJECTS"]</code>, <code>["renamed", "kept", "deleted"]</code>) pour &eacute;viter toute valeur inattendue.</p>
          </div>
        </div>

        <!-- ==================== LIENS ==================== -->
        <h2>Voir aussi</h2>

        <ul>
          <li><a href="./overview.html">Vue d'ensemble du pipeline</a> &mdash; Workflow global et phases</li>
          <li><a href="./prompts.html">Prompts IA</a> &mdash; 20 fichiers prompts, structure, hi&eacute;rarchie</li>
          <li><a href="./phase-batches.html">Phase Batches</a> &mdash; 7 batches d&eacute;taill&eacute;s avec data-flow</li>
        </ul>
      </div>
    </main>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-typescript.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-jsx.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-tsx.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-json.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-sql.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-yaml.min.js"></script>
  <script src="../assets/js/layout.js?v=1.0.4"></script>
  <script src="../assets/js/main.js?v=1.0.4"></script>
</body>
</html>