<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Documentation Technique - FitMyCV.io</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="./assets/css/style.css?v=1.0.4">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
  
  <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
  <script>mermaid.initialize({ startOnLoad: false });</script>
</head>
<body>
  <div class="layout">
    <!-- Sidebar injectée par layout.js -->
    <div id="sidebar-container"></div>

    <!-- Main Content -->
    <main class="main">
      <!-- Header injecté par layout.js -->
      <div id="header-container"></div>

      <div class="content">
        <h1>Documentation Technique FitMyCV<span class="accent">.io</span></h1>
        <p class="lead">
          Guide complet de l'architecture, des fonctionnalités et des pipelines IA de l'application SaaS de génération de CV optimisés.
        </p>

        <div class="callout callout-info">
          <div class="callout-title">Version 1.1.5.1</div>
          <p>Cette documentation reflète la codebase actuelle de FitMyCV.io (mise à jour février 2026). Elle est destinée à servir de référence technique complète pour le développement et la maintenance.</p>
        </div>

        <div class="callout callout-warning">
          <div class="callout-title">Accès réservé</div>
          <p>Cette documentation est accessible uniquement aux administrateurs via l'API <code>/api/admin/docs/</code>.</p>
        </div>

        <h2>Vue d'ensemble du Projet</h2>

        <p><strong>FitMyCV.io</strong> est une application SaaS permettant aux utilisateurs de créer, optimiser et exporter des CV personnalisés grâce à l'intelligence artificielle. L'application analyse les offres d'emploi et adapte automatiquement les CV pour maximiser les chances de sélection.</p>

        <div class="card-grid">
          <div class="card">
            <h4>Stack Technique</h4>
            <p>Next.js 16, React 19, Tailwind CSS 4, PostgreSQL, Prisma 6, OpenAI API, Stripe</p>
          </div>
          <div class="card">
            <h4>Statistiques</h4>
            <p>123 API Routes, 239 Composants React, 34 Modèles Prisma, 30+ Modules lib/, 4 Langues</p>
          </div>
          <div class="card">
            <h4>Pipelines IA</h4>
            <p>Génération CV adapté, Optimisation CV, Scoring matching, Extraction offres, CV Modèle</p>
          </div>
          <div class="card">
            <h4>Modèles Économiques</h4>
            <p>Abonnement + Crédits ou Crédits uniquement, configurable en admin</p>
          </div>
          <div class="card">
            <h4>Extension Navigateur</h4>
            <p>Chrome &amp; Firefox Manifest V3 : détection offres sur 10+ job boards, extraction, génération CV</p>
          </div>
        </div>

        <h2>Architecture Globale</h2>

        <div class="diagram">
          <div class="diagram-title">Architecture en couches</div>
          <div class="mermaid">
flowchart TB
    subgraph Frontend["Frontend (React 19)"]
        UI["Composants d'interface"]
        Providers["Fournisseurs de contexte"]
        Hooks["Hooks personnalisés"]
    end

    subgraph API["Couche API (Next.js)"]
        Routes["123 routes API"]
        Auth["Authentification"]
        Middleware["Middlewares"]
    end

    subgraph Business["Logique metier"]
        CVCore["Gestion des CV"]
        OpenAI["Intelligence artificielle"]
        Subscription["Abonnements"]
        Jobs["Tâches en arrière-plan"]
    end

    subgraph Data["Couche donnees"]
        Prisma["Accès aux données"]
        DB[("PostgreSQL")]
    end

    subgraph External["Services Externes"]
        OpenAIAPI["API OpenAI"]
        StripeAPI["API Stripe"]
        Email["Service d'email"]
    end

    subgraph Extension["Extension Navigateur"]
        Ext["Extension Chrome/Firefox"]
    end

    Frontend --> API
    Extension --> API
    API --> Business
    Business --> Data
    Business --> External
    Data --> DB
    style UI fill:#0ea5e9,stroke:#0284c7,color:#fff
    style Providers fill:#0ea5e9,stroke:#0284c7,color:#fff
    style Hooks fill:#0ea5e9,stroke:#0284c7,color:#fff
    style Routes fill:#6366f1,stroke:#4f46e5,color:#fff
    style Auth fill:#6366f1,stroke:#4f46e5,color:#fff
    style Middleware fill:#6366f1,stroke:#4f46e5,color:#fff
    style CVCore fill:#8b5cf6,stroke:#7c3aed,color:#fff
    style OpenAI fill:#8b5cf6,stroke:#7c3aed,color:#fff
    style Subscription fill:#8b5cf6,stroke:#7c3aed,color:#fff
    style Jobs fill:#8b5cf6,stroke:#7c3aed,color:#fff
    style Prisma fill:#14b8a6,stroke:#0d9488,color:#fff
    style DB fill:#14b8a6,stroke:#0d9488,color:#fff
    style OpenAIAPI fill:#f59e0b,stroke:#d97706,color:#fff
    style StripeAPI fill:#f59e0b,stroke:#d97706,color:#fff
    style Email fill:#f59e0b,stroke:#d97706,color:#fff
    style Ext fill:#22c55e,stroke:#16a34a,color:#fff
          </div>
        </div>

        <h2>Fonctionnalités Principales</h2>

        <h3>Gestion des CV</h3>
        <ul>
          <li><strong>Création manuelle</strong> - Éditeur structuré par sections</li>
          <li><strong>Import PDF</strong> - Extraction IA via GPT-4o Vision</li>
          <li><strong>Versioning</strong> - Historique et restauration des versions</li>
          <li><strong>Export</strong> - PDF (Puppeteer) et DOCX</li>
        </ul>

        <h3>Intelligence Artificielle</h3>
        <ul>
          <li><strong>Pipeline Génération</strong> - Adaptation complète du CV selon l'offre d'emploi</li>
          <li><strong>Pipeline Optimisation</strong> - Amélioration ciblée avec suggestions</li>
          <li><strong>Scoring</strong> - Calcul du match score CV/Offre (0-100)</li>
          <li><strong>Extraction</strong> - Parsing intelligent des offres d'emploi</li>
        </ul>

        <h3>Système de Billing</h3>
        <ul>
          <li><strong>Mode Abonnement</strong> - Plans Free/Pro/Premium avec limites mensuelles</li>
          <li><strong>Mode Crédits</strong> - Paiement à l'usage uniquement</li>
          <li><strong>Intégration Stripe</strong> - Paiements, webhooks, facturation</li>
        </ul>

        <h3>Extension Navigateur</h3>
        <ul>
          <li><strong>Détection automatique</strong> - Reconnaissance des offres sur 10+ job boards</li>
          <li><strong>Extraction intelligente</strong> - HTML vers Markdown via Readability + Turndown</li>
          <li><strong>Intégration SaaS</strong> - Auth JWT, sélection CV, génération directe</li>
          <li><strong>Multi-navigateur</strong> - Chrome et Firefox (Manifest V3)</li>
        </ul>

        <h3>Système</h3>
        <ul>
          <li><strong>Background Jobs</strong> - Queue en mémoire avec concurrence (max 3 globaux)</li>
          <li><strong>Export</strong> - PDF (Puppeteer) et DOCX avec templates personnalisables</li>
          <li><strong>Traduction</strong> - CV multilingue (FR, EN, ES, DE) via OpenAI</li>
          <li><strong>Email</strong> - Double transport SMTP/Resend avec templates dynamiques</li>
          <li><strong>&Eacute;v&eacute;nements SSE</strong> - Temps réel via Server-Sent Events (dbEmitter)</li>
        </ul>

        <h3>Infrastructure</h3>
        <ul>
          <li><strong>Docker</strong> - Build multi-stage (4 stages), Chromium, Puppeteer</li>
          <li><strong>CI/CD</strong> - GitHub Actions (pre-prod + production), versioning automatique</li>
          <li><strong>Middleware</strong> - Rate limiting, CORS extension, security headers CSP/HSTS</li>
          <li><strong>Scripts</strong> - Versioning, migrations de données, sync Stripe, emails</li>
        </ul>

        <h3>S&eacute;curit&eacute; &amp; Conformit&eacute;</h3>
        <ul>
          <li><strong>RGPD</strong> - Consentement cookies, rétention données, audit trail</li>
          <li><strong>S&eacute;curit&eacute; Code</strong> - Validation uploads, sanitisation XSS, logger sécurisé</li>
          <li><strong>Internationalisation</strong> - 4 langues (FR, EN, ES, DE), 40 fichiers locales</li>
        </ul>

        <h2>Structure de la Documentation</h2>

        <table>
          <thead>
            <tr>
              <th>Section</th>
              <th>Contenu</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><strong>Architecture</strong></td>
              <td>Stack technique, patterns, modèles de données</td>
            </tr>
            <tr>
              <td><strong>Authentification</strong></td>
              <td>OAuth, credentials, vérification email</td>
            </tr>
            <tr>
              <td><strong>Gestion CV</strong></td>
              <td>CRUD, versioning, import PDF, structure JSON</td>
            </tr>
            <tr>
              <td><strong>Pipeline Génération</strong></td>
              <td>Phases, batches, prompts, schemas I/O</td>
            </tr>
            <tr>
              <td><strong>Pipeline Optimisation</strong></td>
              <td>Scoring, suggestions, application, review</td>
            </tr>
            <tr>
              <td><strong>G&eacute;n&eacute;ration CV Mod&egrave;le</strong></td>
              <td>Cr&eacute;ation de CV fictifs depuis offre ou titre de poste</td>
            </tr>
            <tr>
              <td><strong>Abonnements & Crédits</strong></td>
              <td>Modèles économiques, Stripe, limites</td>
            </tr>
            <tr>
              <td><strong>Administration</strong></td>
              <td>Dashboard, monitoring, configuration</td>
            </tr>
            <tr>
              <td><strong>Background Jobs &amp; Export</strong></td>
              <td>Queue, concurrence, export PDF/DOCX, traduction</td>
            </tr>
            <tr>
              <td><strong>Onboarding &amp; Email</strong></td>
              <td>9 étapes onboarding, templates email, double transport</td>
            </tr>
            <tr>
              <td><strong>Extension Navigateur</strong></td>
              <td>Architecture Manifest V3, détection, extraction, auth JWT</td>
            </tr>
            <tr>
              <td><strong>API Reference</strong></td>
              <td>123 endpoints documentés (public, auth, admin, extension)</td>
            </tr>
            <tr>
              <td><strong>Composants React</strong></td>
              <td>239 composants en 17 catégories, patterns, architecture</td>
            </tr>
            <tr>
              <td><strong>D&eacute;ploiement &amp; Docker</strong></td>
              <td>Dockerfile multi-stage, CI/CD GitHub Actions, variables d'environnement, health checks</td>
            </tr>
            <tr>
              <td><strong>Middleware &amp; S&eacute;curit&eacute;</strong></td>
              <td>proxy.js, CORS extension, rate limiting, security headers CSP/HSTS</td>
            </tr>
            <tr>
              <td><strong>RGPD &amp; Consentement</strong></td>
              <td>Cookies, consentement utilisateur, rétention données, audit trail CRON</td>
            </tr>
            <tr>
              <td><strong>&Eacute;v&eacute;nements SSE</strong></td>
              <td>Server-Sent Events, dbEmitter, prismaWithEvents, temps réel</td>
            </tr>
            <tr>
              <td><strong>Internationalisation</strong></td>
              <td>4 langues (FR/EN/ES/DE), locales, cvLanguageHelper, extension i18n</td>
            </tr>
            <tr>
              <td><strong>S&eacute;curit&eacute; du Code</strong></td>
              <td>Validation uploads, sanitisation XSS, logger sécurisé avec masquage PII</td>
            </tr>
            <tr>
              <td><strong>Scripts &amp; Automatisation</strong></td>
              <td>Versioning, migrations de données, sync Stripe, export/preview emails</td>
            </tr>
          </tbody>
        </table>

        <h2>Démarrage Rapide</h2>

        <p>Pour explorer la documentation :</p>

        <ol>
          <li>Utilisez la <strong>barre de recherche</strong> pour trouver rapidement un sujet</li>
          <li>Naviguez via le <strong>menu latéral</strong> organisé par domaine</li>
          <li>Consultez les <strong>diagrammes Mermaid</strong> pour visualiser les workflows</li>
          <li>Référez-vous aux <strong>boxes I/O</strong> pour les détails des pipelines IA</li>
        </ol>

        <div class="callout callout-success">
          <div class="callout-title">Maintenance</div>
          <p>Cette documentation doit être mise à jour lors de chaque modification significative de la codebase. Voir les instructions dans <code>CLAUDE.md</code>.</p>
        </div>
      </div>
    </main>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-typescript.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-jsx.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-tsx.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-json.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-sql.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-yaml.min.js"></script>

  <script src="./assets/js/layout.js?v=1.0.4"></script>
  <script src="./assets/js/main.js?v=1.0.5"></script>
</body>
</html>
