{
  "name": "cv_modifications",
  "strict": true,
  "schema": {
    "type": "object",
    "properties": {
      "modifications": {
        "type": "object",
        "description": "Modifications to apply to the source CV",
        "properties": {
          "header": {
            "type": ["object", "null"],
            "description": "Header modifications",
            "properties": {
              "current_title": {
                "type": ["string", "null"],
                "description": "New professional title adapted to the job offer"
              }
            },
            "required": ["current_title"],
            "additionalProperties": false
          },
          "summary": {
            "type": ["object", "null"],
            "description": "Summary/profile modifications (description uniquement)",
            "properties": {
              "description": {
                "type": ["string", "null"],
                "description": "New description adapted to the offer"
              }
            },
            "required": ["description"],
            "additionalProperties": false
          },
          "skills": {
            "type": ["object", "null"],
            "description": "Skills section modifications",
            "properties": {
              "hard_skills": {
                "type": ["object", "null"],
                "description": "Hard skills modifications (CRUD or replace)",
                "properties": {
                  "replace": {
                    "type": ["array", "null"],
                    "items": {
                      "type": "object",
                      "properties": {
                        "name": { "type": "string" },
                        "proficiency": { "type": ["integer", "null"], "enum": [0, 1, 2, 3, 4, 5, null], "description": "0=Awareness, 1=Beginner, 2=Intermediate, 3=Proficient, 4=Advanced, 5=Expert" }
                      },
                      "required": ["name", "proficiency"],
                      "additionalProperties": false
                    },
                    "description": "Replace all skills with this list (alternative to add/remove/update)"
                  },
                  "add": {
                    "type": ["array", "null"],
                    "items": {
                      "type": "object",
                      "properties": {
                        "name": { "type": "string" },
                        "proficiency": { "type": ["integer", "null"], "enum": [0, 1, 2, 3, 4, 5, null], "description": "0=Awareness, 1=Beginner, 2=Intermediate, 3=Proficient, 4=Advanced, 5=Expert" }
                      },
                      "required": ["name", "proficiency"],
                      "additionalProperties": false
                    },
                    "description": "Skills to add with proficiency level"
                  },
                  "remove": {
                    "type": ["array", "null"],
                    "items": { "type": "string" },
                    "description": "Skill names to remove"
                  },
                  "update": {
                    "type": ["array", "null"],
                    "items": {
                      "type": "object",
                      "properties": {
                        "name": { "type": "string" },
                        "proficiency": { "type": "integer", "enum": [0, 1, 2, 3, 4, 5], "description": "0=Awareness, 1=Beginner, 2=Intermediate, 3=Proficient, 4=Advanced, 5=Expert" }
                      },
                      "required": ["name", "proficiency"],
                      "additionalProperties": false
                    },
                    "description": "Skills to update proficiency"
                  },
                  "reorder": {
                    "type": ["array", "null"],
                    "items": { "type": "string" },
                    "description": "New order of skills (by name)"
                  }
                },
                "additionalProperties": false
              },
              "soft_skills": {
                "type": ["object", "null"],
                "description": "Soft skills modifications (CRUD or replace)",
                "properties": {
                  "replace": {
                    "type": ["array", "null"],
                    "items": { "type": "string" },
                    "description": "Replace all soft skills with this list"
                  },
                  "add": {
                    "type": ["array", "null"],
                    "items": { "type": "string" },
                    "description": "Soft skills to add"
                  },
                  "remove": {
                    "type": ["array", "null"],
                    "items": { "type": "string" },
                    "description": "Soft skills to remove"
                  },
                  "reorder": {
                    "type": ["array", "null"],
                    "items": { "type": "string" },
                    "description": "New order of soft skills"
                  }
                },
                "additionalProperties": false
              },
              "tools": {
                "type": ["object", "null"],
                "description": "Tools modifications (CRUD or replace)",
                "properties": {
                  "replace": {
                    "type": ["array", "null"],
                    "items": {
                      "type": "object",
                      "properties": {
                        "name": { "type": "string" },
                        "proficiency": { "type": ["integer", "null"], "enum": [0, 1, 2, 3, 4, 5, null], "description": "0=Awareness, 1=Beginner, 2=Intermediate, 3=Proficient, 4=Advanced, 5=Expert" }
                      },
                      "required": ["name", "proficiency"],
                      "additionalProperties": false
                    },
                    "description": "Replace all tools with this list"
                  },
                  "add": {
                    "type": ["array", "null"],
                    "items": {
                      "type": "object",
                      "properties": {
                        "name": { "type": "string" },
                        "proficiency": { "type": ["integer", "null"], "enum": [0, 1, 2, 3, 4, 5, null], "description": "0=Awareness, 1=Beginner, 2=Intermediate, 3=Proficient, 4=Advanced, 5=Expert" }
                      },
                      "required": ["name", "proficiency"],
                      "additionalProperties": false
                    },
                    "description": "Tools to add with proficiency"
                  },
                  "remove": {
                    "type": ["array", "null"],
                    "items": { "type": "string" },
                    "description": "Tool names to remove"
                  },
                  "update": {
                    "type": ["array", "null"],
                    "items": {
                      "type": "object",
                      "properties": {
                        "name": { "type": "string" },
                        "proficiency": { "type": "integer", "enum": [0, 1, 2, 3, 4, 5], "description": "0=Awareness, 1=Beginner, 2=Intermediate, 3=Proficient, 4=Advanced, 5=Expert" }
                      },
                      "required": ["name", "proficiency"],
                      "additionalProperties": false
                    },
                    "description": "Tools to update proficiency"
                  },
                  "reorder": {
                    "type": ["array", "null"],
                    "items": { "type": "string" },
                    "description": "New order of tools (by name)"
                  }
                },
                "additionalProperties": false
              },
              "methodologies": {
                "type": ["object", "null"],
                "description": "Methodologies modifications (CRUD or replace)",
                "properties": {
                  "replace": {
                    "type": ["array", "null"],
                    "items": { "type": "string" },
                    "description": "Replace all methodologies with this list"
                  },
                  "add": {
                    "type": ["array", "null"],
                    "items": { "type": "string" },
                    "description": "Methodologies to add"
                  },
                  "remove": {
                    "type": ["array", "null"],
                    "items": { "type": "string" },
                    "description": "Methodologies to remove"
                  },
                  "reorder": {
                    "type": ["array", "null"],
                    "items": { "type": "string" },
                    "description": "New order of methodologies"
                  }
                },
                "additionalProperties": false
              }
            },
            "additionalProperties": false
          },
          "experience": {
            "type": ["object", "null"],
            "description": "Experience section modifications",
            "properties": {
              "remove": {
                "type": ["array", "null"],
                "items": { "type": "integer" },
                "description": "Indexes of experiences to remove (0-based, original positions)"
              },
              "move_to_projects": {
                "type": ["array", "null"],
                "items": { "type": "integer" },
                "description": "Indexes of experiences to move to projects section (0-based)"
              },
              "reorder": {
                "type": ["array", "null"],
                "items": { "type": "integer" },
                "description": "New order of experiences by original index (0-based)"
              },
              "updates": {
                "type": "array",
                "items": {
                  "type": "object",
                  "properties": {
                    "index": {
                      "type": "integer",
                      "description": "Index of experience to modify (0-based)"
                    },
                    "changes": {
                      "type": "object",
                      "properties": {
                        "description": {
                          "type": ["string", "null"],
                          "description": "New description"
                        },
                        "responsibilities": {
                          "type": ["object", "null"],
                          "properties": {
                            "add": {
                              "type": "array",
                              "items": { "type": "string" }
                            },
                            "remove": {
                              "type": "array",
                              "items": { "type": "string" }
                            },
                            "update": {
                              "type": "array",
                              "items": {
                                "type": "object",
                                "properties": {
                                  "index": { "type": "integer" },
                                  "value": { "type": "string" }
                                },
                                "required": ["index", "value"],
                                "additionalProperties": false
                              }
                            }
                          },
                          "required": ["add", "remove", "update"],
                          "additionalProperties": false
                        },
                        "deliverables": {
                          "type": ["object", "null"],
                          "properties": {
                            "add": {
                              "type": "array",
                              "items": { "type": "string" }
                            },
                            "remove": {
                              "type": "array",
                              "items": { "type": "string" }
                            },
                            "update": {
                              "type": "array",
                              "items": {
                                "type": "object",
                                "properties": {
                                  "index": { "type": "integer" },
                                  "value": { "type": "string" }
                                },
                                "required": ["index", "value"],
                                "additionalProperties": false
                              }
                            }
                          },
                          "required": ["add", "remove", "update"],
                          "additionalProperties": false
                        },
                        "skills_used": {
                          "type": ["object", "null"],
                          "properties": {
                            "add": {
                              "type": "array",
                              "items": { "type": "string" }
                            },
                            "remove": {
                              "type": "array",
                              "items": { "type": "string" }
                            }
                          },
                          "required": ["add", "remove"],
                          "additionalProperties": false
                        }
                      },
                      "required": ["description", "responsibilities", "deliverables", "skills_used"],
                      "additionalProperties": false
                    }
                  },
                  "required": ["index", "changes"],
                  "additionalProperties": false
                },
                "description": "Updates to apply to specific experiences"
              }
            },
            "additionalProperties": false
          },
          "education": {
            "type": ["object", "null"],
            "description": "Education section modifications",
            "properties": {
              "reorder": {
                "type": ["array", "null"],
                "items": { "type": "integer" },
                "description": "New order by original index"
              }
            },
            "required": ["reorder"],
            "additionalProperties": false
          },
          "languages": {
            "type": ["object", "null"],
            "description": "Languages section modifications",
            "properties": {
              "reorder": {
                "type": ["array", "null"],
                "items": { "type": "string" },
                "description": "New order by language name"
              }
            },
            "required": ["reorder"],
            "additionalProperties": false
          }
        },
        "required": ["header", "summary", "skills", "experience", "education", "languages"],
        "additionalProperties": false
      },
      "reasoning": {
        "type": "string",
        "description": "Brief explanation of adaptation choices (1-2 sentences)"
      }
    },
    "required": ["modifications", "reasoning"],
    "additionalProperties": false
  }
}
