â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                         WORKFLOW DES FEATURES
                     CV Application - OpenAI Integration
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Ce document dÃ©crit le workflow dÃ©taillÃ© de chaque feature de gÃ©nÃ©ration/
amÃ©lioration de CV via l'IA.

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
1. GÃ‰NÃ‰RATION DE CV (generateCv)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Fichier: lib/openai/generateCv.js
EntrÃ©es: mainCvContent, referenceFile, links[], files[], analysisLevel
Sortie: CV adaptÃ© + extraction de l'offre

WORKFLOW:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. âœ… VÃ©rification des crÃ©dits OpenAI
   â””â”€ checkOpenAICredits()

2. ğŸ“¥ Extraction des offres d'emploi (URL)
   Pour chaque URL dans links[]:
   â”œâ”€ Tentative fetch HTTP simple
   â”‚  â””â”€ Si antibot dÃ©tectÃ© â†’ Puppeteer + Stealth plugin
   â”œâ”€ DÃ©tection du titre (pattern H/F)
   â”œâ”€ Optimisation HTML (rÃ©duction contexte)
   â””â”€ Appel GPT (model_extract_job_offer)
      â”œâ”€ System: lib/openai/prompts/extract-job-offer/system.md
      â””â”€ User: lib/openai/prompts/extract-job-offer/user.md
      â””â”€ RÃ©sultat: Extraction structurÃ©e de l'offre

3. ğŸ“„ Extraction des offres d'emploi (PDF)
   Pour chaque PDF dans files[]:
   â”œâ”€ Extraction texte avec pdf2json
   â””â”€ Appel GPT (model_extract_job_offer)
      â”œâ”€ System: lib/openai/prompts/extract-job-offer/system.md
      â””â”€ User: lib/openai/prompts/extract-job-offer/user.md
      â””â”€ RÃ©sultat: Extraction structurÃ©e de l'offre

4. ğŸ”„ CrÃ©ation des runs
   â”œâ”€ 1 run par URL scrapÃ©e
   â”œâ”€ 1 run par PDF extrait
   â””â”€ Si aucune source â†’ 1 run basique

5. ğŸ¤– GÃ©nÃ©ration du CV adaptÃ©
   Pour chaque run:
   â”œâ”€ Construction du contenu de l'offre (jobOfferContent)
   â”œâ”€ RÃ©cupÃ©ration du modÃ¨le selon analysisLevel
   â”‚  â””â”€ model_analysis_rapid/medium/deep
   â””â”€ Appel GPT pour gÃ©nÃ©ration
      â”œâ”€ System: lib/openai/prompts/generate-cv/system.md
      â”‚  â””â”€ Inclut: _shared/cv-improvement-rules.md
      â””â”€ User: lib/openai/prompts/generate-cv/user.md
      â””â”€ Variables: {mainCvContent}, {jobOfferContent}

6. âœ… Validation et formatage
   â”œâ”€ Parse du JSON retournÃ©
   â”œâ”€ VÃ©rification de adapted_cv
   â””â”€ Formatage du CV final

7. ğŸ“¦ RÃ©sultat final
   Pour chaque source:
   â””â”€ { cvContent, source, extractedJobOffer }

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
2. AMÃ‰LIORATION DE CV (improveCv)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Fichier: lib/openai/improveCv.js
EntrÃ©es: cvContent, jobOfferContent, suggestions[], currentScore, analysisLevel
Sortie: CV amÃ©liorÃ© + changements + nouveau score

WORKFLOW:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. âœ… VÃ©rification des crÃ©dits OpenAI
   â””â”€ checkOpenAICredits()

2. ğŸŒ DÃ©tection de la langue du CV
   â””â”€ detectCvLanguage(cvContent)

3. ğŸ“ Formatage des suggestions
   â””â”€ Transformation en liste numÃ©rotÃ©e

4. ğŸ¤– Appel GPT pour amÃ©lioration
   â”œâ”€ RÃ©cupÃ©ration du modÃ¨le selon analysisLevel
   â”‚  â””â”€ model_analysis_rapid/medium/deep
   â””â”€ System: lib/openai/prompts/improve-cv/system.md
      â”œâ”€ Inclut: _shared/language-policy.md
      â”œâ”€ Inclut: _shared/cv-improvement-rules.md
      â””â”€ Variables: {cvLanguage}
   â””â”€ User: lib/openai/prompts/improve-cv/user.md
      â”œâ”€ Inclut: _shared/cv-improvement-rules.md
      â”œâ”€ Inclut: _shared/scoring-rules.md
      â””â”€ Variables: {currentScore}, {jobOfferContent}, {cvContent}, {suggestionsText}

5. âœ… Validation de la rÃ©ponse
   â”œâ”€ Parse du JSON
   â”œâ”€ VÃ©rification de improved_cv
   â””â”€ Calcul du nouveau score

6. ğŸ“¦ RÃ©sultat final
   â””â”€ { improved_cv, changes_made, new_estimated_score, new_suggestions }

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
3. CALCUL DU SCORE (calculateMatchScoreWithAnalysis)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Fichier: lib/openai/calculateMatchScoreWithAnalysis.js
EntrÃ©es: cvContent, jobOfferUrl, cvFile?, previousScore?, previousScoreUpdatedAt?
Sortie: matchScore + scoreBreakdown + suggestions + skills

WORKFLOW:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. âœ… VÃ©rification des crÃ©dits OpenAI
   â””â”€ checkOpenAICredits()

2. ğŸ“¥ RÃ©cupÃ©ration de l'offre d'emploi
   â”œâ”€ SI extractedJobOffer en cache (cvFile.extractedJobOffer)
   â”‚  â””â”€ Utiliser le cache
   â””â”€ SINON: Extraction avec Puppeteer + GPT
      â”œâ”€ Puppeteer en mode stealth
      â”œâ”€ DÃ©tection du titre (pattern H/F)
      â”œâ”€ Optimisation HTML
      â””â”€ Appel GPT (model_extract_job_offer)
         â”œâ”€ System: lib/openai/prompts/extract-job-offer/system.md
         â””â”€ User: lib/openai/prompts/extract-job-offer/user.md

3. ğŸŒ DÃ©tection des langues
   â”œâ”€ detectCvLanguage(cvData)
   â”œâ”€ detectJobOfferLanguage(jobOfferContent)
   â””â”€ SI langues diffÃ©rentes:
      â””â”€ CrÃ©ation instruction de traduction

4. ğŸ¤– Appel GPT pour analyse et scoring
   â”œâ”€ ModÃ¨le: model_match_score
   â”œâ”€ System: lib/openai/prompts/scoring/system.md
   â”‚  â”œâ”€ Inclut: _shared/language-policy.md
   â”‚  â”œâ”€ Inclut: _shared/response-format.md
   â”‚  â””â”€ Variables: {cvLanguage}, {translationInstruction}
   â””â”€ User: lib/openai/prompts/scoring/user.md
      â”œâ”€ Inclut: _shared/scoring-rules.md
      â””â”€ Variables: {cvContent}, {jobOfferContent}

5. âœ… Validation et nettoyage
   â”œâ”€ Parse du JSON
   â”œâ”€ Validation des scores (0-100)
   â””â”€ Extraction des tableaux (suggestions, skills)

6. ğŸ”„ Logique de score incrÃ©mental
   â”œâ”€ SI premier calcul:
   â”‚  â””â”€ Retourner score GPT tel quel
   â”œâ”€ SI < 5 min depuis dernier calcul:
   â”‚  â””â”€ Retourner mÃªme score (nouvelles suggestions)
   â””â”€ SI > 5 min depuis dernier calcul:
      â””â”€ score + (0 Ã  3 points alÃ©atoires)

7. ğŸ“Š Ajustement du scoreBreakdown
   â””â”€ Formule: score = (techÃ—0.35) + (expÃ—0.30) + (eduÃ—0.20) + (softÃ—0.15)

8. ğŸ“¦ RÃ©sultat final
   â””â”€ { matchScore, scoreBreakdown, suggestions, missingSkills, matchingSkills }

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
4. TRADUCTION DE CV (translateCv)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Fichier: lib/openai/translateCv.js
EntrÃ©es: cvContent, targetLanguage, signal
Sortie: CV traduit

WORKFLOW:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. âœ… VÃ©rification des crÃ©dits OpenAI
   â””â”€ checkOpenAICredits()

2. ğŸŒ Mapping de la langue
   â””â”€ fr â†’ "franÃ§ais", en â†’ "anglais"

3. ğŸ¤– Appel GPT pour traduction
   â”œâ”€ ModÃ¨le: model_translate_cv
   â”œâ”€ Temperature: 0.3 (cohÃ©rence)
   â”œâ”€ System: lib/openai/prompts/translate-cv/system.md
   â”‚  â””â”€ Inclut: _shared/language-policy.md
   â””â”€ User: lib/openai/prompts/translate-cv/user.md
      â””â”€ Variables: {targetLanguage}, {cvContent}

4. âœ… Validation
   â””â”€ Parse du JSON pour valider

5. ğŸ“¦ RÃ©sultat final
   â””â”€ CV traduit au format JSON

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
5. IMPORT DEPUIS PDF (importPdfCv)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Fichier: lib/openai/importPdf.js
EntrÃ©es: pdfFilePath, analysisLevel, requestedModel?
Sortie: CV structurÃ© au format JSON

WORKFLOW:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. âœ… VÃ©rification des crÃ©dits OpenAI
   â””â”€ checkOpenAICredits()

2. ğŸ“„ Extraction du texte du PDF
   â””â”€ pdf2json (extractTextFromPdf)

3. ğŸ“‹ RÃ©cupÃ©ration du schÃ©ma de rÃ©fÃ©rence
   â””â”€ data/template.json

4. ğŸ¤– Appel GPT pour structuration
   â”œâ”€ RÃ©cupÃ©ration du modÃ¨le selon analysisLevel
   â”‚  â””â”€ model_analysis_rapid/medium/deep
   â”œâ”€ System: lib/openai/prompts/import-pdf/system.md
   â”‚  â””â”€ Inclut: _shared/language-policy.md
   â””â”€ User: lib/openai/prompts/import-pdf/user.md
      â””â”€ Variables: {cvSchema}, {pdfText}

5. âœ… Validation
   â”œâ”€ Parse du JSON
   â””â”€ VÃ©rification de la structure

6. ğŸ·ï¸ Enrichissement avec mÃ©tadonnÃ©es
   â”œâ”€ created_at
   â”œâ”€ generator: "pdf_import"
   â””â”€ source: chemin du PDF

7. ğŸ“¦ RÃ©sultat final
   â””â”€ CV structurÃ© au format JSON + mÃ©tadonnÃ©es

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
6. CRÃ‰ATION DE CV TEMPLATE (createTemplateCv)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Fichier: lib/openai/createTemplateCv.js
EntrÃ©es: links[], files[], analysisLevel, requestedModel?
Sortie: CV modÃ¨le fictif adaptÃ© Ã  l'offre

WORKFLOW:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. âœ… VÃ©rification des crÃ©dits OpenAI
   â””â”€ checkOpenAICredits()

2. ğŸ“‹ RÃ©cupÃ©ration du schÃ©ma de rÃ©fÃ©rence
   â””â”€ data/template.json

3. ğŸ“¥ Extraction des offres d'emploi (URL)
   Pour chaque URL dans links[]:
   â”œâ”€ Puppeteer en mode stealth
   â”œâ”€ DÃ©tection du titre (pattern H/F)
   â”œâ”€ Optimisation HTML
   â””â”€ Appel GPT (model_extract_job_offer)
      â””â”€ Prompt inline (pas de fichier .md)

4. ğŸ“„ Extraction des offres d'emploi (PDF)
   Pour chaque PDF dans files[]:
   â”œâ”€ Extraction texte avec pdf2json
   â””â”€ Appel GPT (model_extract_job_offer)
      â””â”€ Prompt inline (pas de fichier .md)

5. ğŸ”„ CrÃ©ation des runs
   â”œâ”€ 1 run par URL scrapÃ©e
   â”œâ”€ 1 run par PDF extrait
   â””â”€ Si aucune source â†’ 1 run basique

6. ğŸ¤– GÃ©nÃ©ration du CV modÃ¨le
   Pour chaque run:
   â”œâ”€ Construction du contenu de l'offre (jobOfferContent)
   â”œâ”€ RÃ©cupÃ©ration du modÃ¨le selon analysisLevel
   â”‚  â””â”€ model_analysis_rapid/medium/deep
   â””â”€ Appel GPT pour gÃ©nÃ©ration
      â”œâ”€ System: lib/openai/prompts/create-template/system.md
      â”‚  â””â”€ Inclut: _shared/language-policy.md
      â””â”€ User: lib/openai/prompts/create-template/user.md
         â””â”€ Variables: {cvSchema}, {jobOfferContent}

7. âœ… Validation
   â”œâ”€ Parse du JSON
   â””â”€ VÃ©rification de la structure

8. ğŸ“¦ RÃ©sultat final
   Pour chaque source:
   â””â”€ { cvContent, source, extractedJobOffer }

NOTE: CrÃ©e des profils fictifs mais rÃ©alistes (junior/confirmÃ©/senior)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
7. GÃ‰NÃ‰RATION DEPUIS TITRE DE POSTE (generateCvFromJobTitle)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Fichier: lib/openai/generateCvFromJobTitle.js
EntrÃ©es: jobTitle, language, analysisLevel, requestedModel?
Sortie: CV modÃ¨le adaptÃ© au titre de poste

WORKFLOW:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. âœ… VÃ©rification des crÃ©dits OpenAI
   â””â”€ checkOpenAICredits()

2. âœ… Validation du titre (DÃ‰SACTIVÃ‰E)
   â””â”€ Tous les titres sont acceptÃ©s automatiquement

3. ğŸ“‹ RÃ©cupÃ©ration du schÃ©ma de rÃ©fÃ©rence
   â””â”€ data/template.json

4. ğŸ¤– Appel GPT pour gÃ©nÃ©ration
   â”œâ”€ ModÃ¨le: model_generate_from_job_title
   â”œâ”€ System: lib/openai/prompts/generate-from-job-title/system.md
   â”‚  â””â”€ Inclut: _shared/language-policy.md
   â””â”€ User: lib/openai/prompts/generate-from-job-title/user.md
      â””â”€ Variables: {jobTitle}, {language}, {cvSchema}

5. âœ… Validation
   â”œâ”€ Parse du JSON
   â””â”€ VÃ©rification des champs essentiels:
      â”œâ”€ header.full_name
      â””â”€ header.current_title

6. ğŸ“¦ RÃ©sultat final
   â””â”€ CV modÃ¨le au format JSON

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
8. CALCUL DU SCORE (LEGACY) (calculateMatchScore)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Fichier: lib/openai/calculateMatchScore.js
NOTE: Version legacy, remplacÃ©e par calculateMatchScoreWithAnalysis.js

WORKFLOW:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

1. ğŸ“¥ Extraction de l'offre d'emploi
   â”œâ”€ Puppeteer en mode stealth
   â”œâ”€ DÃ©tection du titre (pattern H/F)
   â”œâ”€ Optimisation HTML
   â””â”€ Appel GPT (model_extract_job_offer)
      â””â”€ Prompt inline (pas de fichier .md)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
LÃ‰GENDE DES SYMBOLES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… = VÃ©rification/Validation
ğŸ“¥ = Extraction d'entrÃ©e
ğŸ“„ = Traitement de fichier
ğŸŒ = DÃ©tection de langue
ğŸ“ = Formatage de donnÃ©es
ğŸ¤– = Appel GPT/IA
ğŸ”„ = Boucle/ItÃ©ration
ğŸ“Š = Calcul/Analyse
ğŸ·ï¸ = Ajout de mÃ©tadonnÃ©es
ğŸ“‹ = RÃ©cupÃ©ration de schÃ©ma
ğŸ“¦ = RÃ©sultat final

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
POINTS COMMUNS Ã€ TOUTES LES FEATURES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. VÃ©rification des crÃ©dits OpenAI
   â””â”€ checkOpenAICredits() avant toute opÃ©ration longue

2. Support de l'annulation
   â””â”€ AbortSignal pour interrompre les appels GPT

3. Gestion des erreurs
   â”œâ”€ Parse des rÃ©ponses JSON
   â”œâ”€ Validation des structures
   â””â”€ Propagation des erreurs avec messages clairs

4. Configuration des modÃ¨les
   â”œâ”€ Tous depuis la base de donnÃ©es (table Setting)
   â””â”€ Pas de fallback hardcodÃ© (sauf checkOpenAICredits)

5. Cache en mÃ©moire
   â””â”€ Settings AI Models pour performance

6. Logs dÃ©taillÃ©s
   â””â”€ Console.log pour suivi du workflow

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
FIN DU DOCUMENT
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
